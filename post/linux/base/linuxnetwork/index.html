<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Linux网络管理 - Mythos · Java Developer</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Kuangcp" /><meta name="description" content="💠 Linux网络管理 1.1. 内核配置 1.2. DNS 1.2.1. nslookup 1.2.2. dig 1.2.3. 修改DNS 1.3. Route 1.3.1. traceroute 1.4. IPv4和IPv6 1.5. Bridge 1.6. Socket 1.7. TCP/UDP 工具 1.7.1. 进程和端口互查 1.7.2. tcpdump 1.8. 复合工具 1.8.1. ping 1.8.2. tc 流量" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.99.0 with theme even" />


<link rel="canonical" href="https://www.kuangcp.top/post/linux/base/linuxnetwork/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Linux网络管理" />
<meta property="og:description" content="💠 Linux网络管理 1.1. 内核配置 1.2. DNS 1.2.1. nslookup 1.2.2. dig 1.2.3. 修改DNS 1.3. Route 1.3.1. traceroute 1.4. IPv4和IPv6 1.5. Bridge 1.6. Socket 1.7. TCP/UDP 工具 1.7.1. 进程和端口互查 1.7.2. tcpdump 1.8. 复合工具 1.8.1. ping 1.8.2. tc 流量" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.kuangcp.top/post/linux/base/linuxnetwork/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-12-15T11:15:55+00:00" />
<meta property="article:modified_time" content="2018-12-15T11:15:55+00:00" />

<meta itemprop="name" content="Linux网络管理">
<meta itemprop="description" content="💠 Linux网络管理 1.1. 内核配置 1.2. DNS 1.2.1. nslookup 1.2.2. dig 1.2.3. 修改DNS 1.3. Route 1.3.1. traceroute 1.4. IPv4和IPv6 1.5. Bridge 1.6. Socket 1.7. TCP/UDP 工具 1.7.1. 进程和端口互查 1.7.2. tcpdump 1.8. 复合工具 1.8.1. ping 1.8.2. tc 流量"><meta itemprop="datePublished" content="2018-12-15T11:15:55+00:00" />
<meta itemprop="dateModified" content="2018-12-15T11:15:55+00:00" />
<meta itemprop="wordCount" content="7715">
<meta itemprop="keywords" content="基础,网络," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Linux网络管理"/>
<meta name="twitter:description" content="💠 Linux网络管理 1.1. 内核配置 1.2. DNS 1.2.1. nslookup 1.2.2. dig 1.2.3. 修改DNS 1.3. Route 1.3.1. traceroute 1.4. IPv4和IPv6 1.5. Bridge 1.6. Socket 1.7. TCP/UDP 工具 1.7.1. 进程和端口互查 1.7.2. tcpdump 1.8. 复合工具 1.8.1. ping 1.8.2. tc 流量"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Mythos</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Mythos</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Linux网络管理</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-12-15 </span>
        <div class="post-category">
            <a href="/categories/linux/"> Linux </a>
            </div>
          <span class="more-meta"> 7715 words </span>
          <span class="more-meta"> 16 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#linux网络管理">Linux网络管理</a>
      <ul>
        <li><a href="#内核配置">内核配置</a></li>
        <li><a href="#dns">DNS</a>
          <ul>
            <li><a href="#nslookup">nslookup</a></li>
            <li><a href="#dig">dig</a></li>
            <li><a href="#修改dns">修改DNS</a></li>
          </ul>
        </li>
        <li><a href="#route">Route</a>
          <ul>
            <li><a href="#traceroute">traceroute</a></li>
          </ul>
        </li>
        <li><a href="#ipv4和ipv6">IPv4和IPv6</a></li>
        <li><a href="#bridge">Bridge</a></li>
        <li><a href="#socket">Socket</a></li>
        <li><a href="#tcpudp-工具">TCP/UDP 工具</a>
          <ul>
            <li><a href="#进程和端口互查">进程和端口互查</a></li>
            <li><a href="#tcpdump">tcpdump</a></li>
          </ul>
        </li>
        <li><a href="#复合工具">复合工具</a>
          <ul>
            <li><a href="#ping">ping</a></li>
            <li><a href="#tc-流量控制">tc 流量控制</a></li>
            <li><a href="#netstat">netstat</a></li>
            <li><a href="#iproute2">iproute2</a></li>
            <li><a href="#nmap">nmap</a></li>
            <li><a href="#netcat">netcat</a></li>
            <li><a href="#scp">scp</a></li>
            <li><a href="#rsync">rsync</a></li>
            <li><a href="#curl">curl</a></li>
            <li><a href="#wget">wget</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#证书">证书</a>
      <ul>
        <li><a href="#自签发证书">自签发证书</a></li>
      </ul>
    </li>
    <li><a href="#常用服务">常用服务</a>
      <ul>
        <li><a href="#邮件服务器">邮件服务器</a></li>
        <li><a href="#ftp">FTP</a>
          <ul>
            <li><a href="#客户端">客户端</a></li>
            <li><a href="#服务端">服务端</a></li>
          </ul>
        </li>
        <li><a href="#ssh">SSH</a></li>
        <li><a href="#telnet">Telnet</a></li>
        <li><a href="#vpn">VPN</a>
          <ul>
            <li><a href="#tuntap">tun/tap</a></li>
            <li><a href="#shadowsocks">shadowsocks</a></li>
            <li><a href="#openvpn">OpenVPN</a></li>
            <li><a href="#fortivpn">Fortivpn</a></li>
          </ul>
        </li>
        <li><a href="#代理">代理</a>
          <ul>
            <li><a href="#端口转发">端口转发</a></li>
            <li><a href="#proxychains">proxychains</a></li>
          </ul>
        </li>
        <li><a href="#防火墙">防火墙</a>
          <ul>
            <li><a href="#iptables">iptables</a></li>
          </ul>
        </li>
        <li><a href="#远程桌面">远程桌面</a>
          <ul>
            <li><a href="#vnc">VNC</a></li>
            <li><a href="#xrdp">Xrdp</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#tips">Tips</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>💠</p>
<ul>
<li>
<ol>
<li><a href="#linux%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86">Linux网络管理</a></li>
</ol>
<ul>
<li>1.1. <a href="#%E5%86%85%E6%A0%B8%E9%85%8D%E7%BD%AE">内核配置</a></li>
<li>1.2. <a href="#dns">DNS</a>
<ul>
<li>1.2.1. <a href="#nslookup">nslookup</a></li>
<li>1.2.2. <a href="#dig">dig</a></li>
<li>1.2.3. <a href="#%E4%BF%AE%E6%94%B9dns">修改DNS</a></li>
</ul>
</li>
<li>1.3. <a href="#route">Route</a>
<ul>
<li>1.3.1. <a href="#traceroute">traceroute</a></li>
</ul>
</li>
<li>1.4. <a href="#ipv4%E5%92%8Cipv6">IPv4和IPv6</a></li>
<li>1.5. <a href="#bridge">Bridge</a></li>
<li>1.6. <a href="#socket">Socket</a></li>
<li>1.7. <a href="#tcpudp-%E5%B7%A5%E5%85%B7">TCP/UDP 工具</a>
<ul>
<li>1.7.1. <a href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%AB%AF%E5%8F%A3%E4%BA%92%E6%9F%A5">进程和端口互查</a></li>
<li>1.7.2. <a href="#tcpdump">tcpdump</a></li>
</ul>
</li>
<li>1.8. <a href="#%E5%A4%8D%E5%90%88%E5%B7%A5%E5%85%B7">复合工具</a>
<ul>
<li>1.8.1. <a href="#ping">ping</a></li>
<li>1.8.2. <a href="#tc-%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6">tc 流量控制</a></li>
<li>1.8.3. <a href="#netstat">netstat</a></li>
<li>1.8.4. <a href="#iproute2">iproute2</a></li>
<li>1.8.5. <a href="#nmap">nmap</a></li>
<li>1.8.6. <a href="#netcat">netcat</a></li>
<li>1.8.7. <a href="#scp">scp</a></li>
<li>1.8.8. <a href="#rsync">rsync</a></li>
<li>1.8.9. <a href="#curl">curl</a></li>
<li>1.8.10. <a href="#wget">wget</a></li>
</ul>
</li>
</ul>
</li>
<li>
<ol start="2">
<li><a href="#%E8%AF%81%E4%B9%A6">证书</a></li>
</ol>
<ul>
<li>2.1. <a href="#%E8%87%AA%E7%AD%BE%E5%8F%91%E8%AF%81%E4%B9%A6">自签发证书</a></li>
</ul>
</li>
<li>
<ol start="3">
<li><a href="#%E5%B8%B8%E7%94%A8%E6%9C%8D%E5%8A%A1">常用服务</a></li>
</ol>
<ul>
<li>3.1. <a href="#%E9%82%AE%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8">邮件服务器</a></li>
<li>3.2. <a href="#ftp">FTP</a>
<ul>
<li>3.2.1. <a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF">客户端</a>
<ul>
<li>3.2.1.1. <a href="#%E5%91%BD%E4%BB%A4%E8%A1%8C">命令行</a></li>
<li>3.2.1.2. <a href="#java">Java</a></li>
</ul>
</li>
<li>3.2.2. <a href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF">服务端</a>
<ul>
<li>3.2.2.1. <a href="#ftpserver">ftpserver</a></li>
<li>3.2.2.2. <a href="#vsftpd">vsftpd</a></li>
</ul>
</li>
</ul>
</li>
<li>3.3. <a href="#ssh">SSH</a></li>
<li>3.4. <a href="#telnet">Telnet</a></li>
<li>3.5. <a href="#vpn">VPN</a>
<ul>
<li>3.5.1. <a href="#tuntap">tun/tap</a></li>
<li>3.5.2. <a href="#shadowsocks">shadowsocks</a></li>
<li>3.5.3. <a href="#openvpn">OpenVPN</a></li>
<li>3.5.4. <a href="#fortivpn">Fortivpn</a></li>
</ul>
</li>
<li>3.6. <a href="#%E4%BB%A3%E7%90%86">代理</a>
<ul>
<li>3.6.1. <a href="#%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91">端口转发</a></li>
<li>3.6.2. <a href="#proxychains">proxychains</a></li>
</ul>
</li>
<li>3.7. <a href="#%E9%98%B2%E7%81%AB%E5%A2%99">防火墙</a>
<ul>
<li>3.7.1. <a href="#iptables">iptables</a>
<ul>
<li>3.7.1.1. <a href="#%E5%9B%9B%E5%B1%82%E5%8D%8F%E8%AE%AE%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91">四层协议端口转发</a></li>
</ul>
</li>
</ul>
</li>
<li>3.8. <a href="#%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2">远程桌面</a>
<ul>
<li>3.8.1. <a href="#vnc">VNC</a></li>
<li>3.8.2. <a href="#xrdp">Xrdp</a></li>
</ul>
</li>
</ul>
</li>
<li>
<ol start="4">
<li><a href="#tips">Tips</a></li>
</ol>
</li>
</ul>
<p>💠 2025-05-09 14:24:14</p>
<hr>
<h1 id="linux网络管理">Linux网络管理</h1>
<blockquote>
<p><a href="/Skills/Network/Network.md">计算机网络基础</a></p>
</blockquote>
<h2 id="内核配置">内核配置</h2>
<blockquote>
<p>ip_local_port_range <a href="https://ma.ttias.be/linux-increase-ip_local_port_range-tcp-port-range/">Linux increase ip_local_port_range TCP port range</a></p>
</blockquote>
<blockquote>
<p><a href="https://tlanyan.me/linux-traffic-commands/">参考: Linux查看网络流量</a></p>
</blockquote>
<p>iftop</p>
<ul>
<li>nethogs <code>流量监控</code></li>
<li>slurm 网卡带宽监控</li>
</ul>
<hr>
<h2 id="dns">DNS</h2>
<blockquote>
<p><a href="https://github.com/topics/dns">Github: dns topic</a>
<a href="https://github.com/TechnitiumSoftware/DnsServer">DnsServer</a></p>
</blockquote>
<h3 id="nslookup">nslookup</h3>
<blockquote>
<p>来自 dnsutils 包</p>
</blockquote>
<p>快速使用 <code>nslookup jd.com 223.5.5.5</code></p>
<ul>
<li><code>nslookup - 8.8.8.8</code> 进入 REPL 方便调试, 8.8.8.8 是Google开放的DNS 备选 8.8.4.4
<ul>
<li>结果解释：Non-authoritative answer: 表示这是从缓存得到的结果，不一定准确</li>
<li>Server：上连DNS服务器的IP， Address：<code>上连DNS的IP#端口</code> 通常是53</li>
<li>canonical name 即CNAME 别名</li>
</ul>
</li>
</ul>
<h3 id="dig">dig</h3>
<blockquote>
<p>比 nslookup 更强大 <strong>Domain Information Groper</strong></p>
</blockquote>
<p>快速使用 <code>dig @8.8.8.8 www.baidu.com</code></p>
<blockquote>
<p>dig [option] @8.8.8.8 <a href="https://www.baidu.com">www.baidu.com</a></p>
</blockquote>
<ul>
<li>@xxx 指定DNS服务器</li>
<li>-p 53 指定DNS服务器端口</li>
<li>+tcp 采用TCP进行DNS通信（默认UDP）</li>
<li>+short 精简输出</li>
<li>+nocmd+nocomment+nostat 输出最核心内容</li>
<li>-p</li>
</ul>
<p><code>dog</code> 类似dig</p>
<ul>
<li>
<p><code>drill</code></p>
<ul>
<li><a href="https://linux.die.net/man/1/drill">doc</a></li>
</ul>
</li>
<li>
<p><code>host</code></p>
<ul>
<li>host domain</li>
</ul>
</li>
<li>
<p><code>whois</code></p>
<ul>
<li>查询域名详细信息</li>
</ul>
</li>
<li>
<p><code>nali</code> <a href="https://github.com/zu1k/nali">Github</a></p>
</li>
</ul>
<hr>
<h3 id="修改dns">修改DNS</h3>
<ul>
<li>在 <code>/etc/resolv.conf</code> 中添加Google的DNS (阿里云 DNS 223.5.5.5 223.6.6.6)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    nameserver 8.8.8.8 
</span></span><span class="line"><span class="cl">    nameserver 8.8.8.4
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>刷新本地缓存</p>
</blockquote>
<ol>
<li>sudo /etc/init.d/nscd restart 或者 service nscd restart , 其实就是重启 nscd 服务</li>
</ol>
<hr>
<h2 id="route">Route</h2>
<blockquote>
<p><a href="https://blog.csdn.net/qq_34328833/article/details/60583183">参考: 路由表的建立算法和有关的刷新协议</a></p>
</blockquote>
<blockquote>
<p><a href="https://github.com/garywill/linux-router">Linux-router</a><code>Linux作为路由器</code></p>
</blockquote>
<h3 id="traceroute">traceroute</h3>
<blockquote>
<p>显示网络数据包传输到指定主机的路径信息，追踪数据传输路由状况</p>
</blockquote>
<ul>
<li><code>traceroute [选项] [远程主机名或IP地址] [数据包大小]</code>
<ul>
<li>-i&lt;网络接口&gt;	:	使用指定的网络接口发送数据包</li>
<li>-n	:	直接使用IP地址而不使用主机名</li>
<li>-v	:	详细显示命令的执行过程</li>
<li>-w&lt;超时秒数&gt;	:	设置等待远程主机回应的时间</li>
<li>-x	:	开启或者关闭对数据包的正确性校验</li>
<li>-s&lt;来源IP&gt;	:	设置本机主机发送数据包的IP地址</li>
<li>-g&lt;网关地址&gt;	：	设置来源的路由网关，最多可设置8个</li>
</ul>
</li>
</ul>
<ol>
<li><code>traceroute -I stackoverflow.com</code> icmp 查看路由表</li>
</ol>
<blockquote>
<p><a href="https://github.com/nxtrace/NTrace-core">NTrace-core </a><code>可视化</code></p>
</blockquote>
<hr>
<h2 id="ipv4和ipv6">IPv4和IPv6</h2>
<ul>
<li>IPv4 只有32bit IPv6 有128bit</li>
</ul>
<p><code>IPv6</code></p>
<ul>
<li>零省略 ：如果有一位是 000C 可以直接写C</li>
<li>零压缩 ：如果FE04:0:0:0:0:0:0:DA 写成 FE::DA</li>
</ul>
<h2 id="bridge">Bridge</h2>
<blockquote>
<p>网桥, 通常使用 bridge-utils 的 brctl 进行管理</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"> Learn</li>
</ul>
<p><strong>增加</strong></p>
<p><strong>删除</strong></p>
<p><strong>配置开机启动</strong></p>
<h2 id="socket">Socket</h2>
<p>一个socket的五个必要元素： client_ip:client_port&lt;&mdash;&ndash;&gt;server_ip:server_port + 协议</p>
<p><code>/etc/sysctl.conf</code>
动态端口范围： net.ipv4.ip_local_port_range=32788 60000 <code>修改时不能超过[1024,65535]范围</code></p>
<hr>
<h2 id="tcpudp-工具">TCP/UDP 工具</h2>
<ul>
<li>
<p><a href="https://christmica.cc/archives/tcp-download-analysis">TCP 内网下载慢速分析</a></p>
</li>
<li>
<p>强制关闭tcp连接： killcx tcpkill</p>
</li>
<li>
<p><code>iperf3</code>： TCP UDP 测速， 在两个节点上使用iperf启动服务端和客户端进程，从而计算TCP和UDP指标信息 <a href="https://github.com/microsoft/ethr">Ethr</a> Golang 仿写</p>
</li>
</ul>
<h3 id="进程和端口互查">进程和端口互查</h3>
<blockquote>
<p>netstat lsof fuser</p>
</blockquote>
<blockquote>
<p><a href="http://blog.csdn.net/ws379374000/article/details/74218530">参考: linux下常用命令查看端口占用</a></p>
</blockquote>
<ul>
<li>
<p><code>lsof -i:端口号</code> 用于查看某一端口的占用情况，缺省端口号显示全部</p>
<ul>
<li>或者 <code>cat /etc/services</code> 查看系统以及使用的端口</li>
</ul>
</li>
<li>
<p>查询占用端口 <code>fuser -v -n tcp 22</code> 或者 <code>fuser -v 22/tcp</code> fuser中含三种协议： file 默认, tcp, udp</p>
<ul>
<li>得到一些进程信息 <code>fuser -v -n tcp 0</code></li>
</ul>
</li>
<li>
<p>whatportis 可以通过服务查询默认端口，或者是通过端口查询默认服务的工具</p>
</li>
</ul>
<hr>
<h3 id="tcpdump">tcpdump</h3>
<ul>
<li>
<p><code>tcpdump -i eth0 -nn -X 'port 53' -c 1</code> root用户才有运行权限</p>
<ul>
<li>-i 指定监听的网络接口（网卡）</li>
<li>-nn 将协议号或端口号，显示数字，而不是名称例如：21 而不显示 FTP</li>
<li>-X 将协议头和包内容完整的显示出来</li>
<li>port 53 过滤，只显示53端口相关的包</li>
<li>-c 抓包的数量</li>
<li>-e 输出以太网帧头部信息输出 （能看到mac地址）</li>
<li>-l 输出变为行缓冲</li>
<li>-t 输出不打印时间戳</li>
<li>-v 输出更详细信息</li>
<li>-F 指定过滤表达式所在的文件</li>
<li>-w 将流量保存到文件中</li>
<li>-r 读取raw packets 文件</li>
</ul>
</li>
<li>
<p>列出可以选择的抓包对象 <code>tcpdump -D</code>（USB设备也能抓？）</p>
</li>
</ul>
<hr>
<h2 id="复合工具">复合工具</h2>
<blockquote>
<p>参考书籍 《Linux 大棚命令百篇》</p>
</blockquote>
<h3 id="ping">ping</h3>
<blockquote>
<p>inetutils-ping ICMP protocol</p>
</blockquote>
<ul>
<li>ping URL ： Linux是默认无休止的
<ul>
<li>-c 次数</li>
<li>-q 安静模式 不输出</li>
<li>-s 默认64字节</li>
<li>-t 设定 TTL值，Linux默认是64或255 经过一个路由器就会减一</li>
<li>-i 每次ping的时间间隔 默认1s root用户才可以设置 0.2 以下</li>
<li>-f 暴力尽可能大量包的传送 至少每秒100个
<ul>
<li>注意：得到的结果中的 mdev 表示ICMP包的RTT偏离平均值的程度，mdev 越大表示网速不稳定 Linux有，mac下叫stddev win系列没有</li>
</ul>
</li>
<li>-r 记录经过的路由 （路由节点均支持ICMP协议）</li>
</ul>
</li>
</ul>
<blockquote>
<p><a href="http://denilson.sa.nom.br/prettyping/">prettyping</a><br>
<a href="https://github.com/orf/gping">gping</a></p>
</blockquote>
<ul>
<li>ping -s 1472 -M do 192.168.15.205 测试网络环境下最大可用MTU</li>
<li><a href="https://github.com/pouriyajamshidi/tcping">Github: tcping</a> <code>测试tcp连接延迟</code></li>
</ul>
<h3 id="tc-流量控制">tc 流量控制</h3>
<blockquote>
<p>Traffic Control</p>
</blockquote>
<ul>
<li>
<p>限速 <code>tc qdisc add dev eno1 root tbf rate 400kbit latency 1ms burst 1000</code></p>
</li>
<li>
<p>解除 <code>tc qdisc del dev eno1 root tbf rate 400kbit latency 1ms burst 1000</code></p>
<ul>
<li>tbf : 令牌桶算法</li>
</ul>
</li>
<li>
<p>网卡100%丢包 <code>tc qdisc add dev enp3s0 root netem loss 100%</code> 移除限制： add 换成 del</p>
</li>
<li>
<p>移除指定网卡添加的所有规则 <code>tc qdisc del dev enp3s0 root</code></p>
</li>
<li>
<p>指定IP网段 丢包</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">    <span class="c1">#! /bin/sh</span>
</span></span><span class="line"><span class="cl">    <span class="nv">interface</span><span class="o">=</span>enp3s0
</span></span><span class="line"><span class="cl">    <span class="nv">ip</span><span class="o">=</span>192.168.16.0/24
</span></span><span class="line"><span class="cl">    <span class="nv">delay</span><span class="o">=</span>30ms
</span></span><span class="line"><span class="cl">    <span class="nv">loss</span><span class="o">=</span>90%
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    tc qdisc add dev <span class="nv">$interface</span> root handle 1: prio
</span></span><span class="line"><span class="cl">    <span class="c1"># 此命令立即创建了类: 1:1, 1:2, 1:3 ( 缺省三个子类 )</span>
</span></span><span class="line"><span class="cl">    tc filter add dev <span class="nv">$interface</span> parent 1:0 protocol ip prio <span class="m">1</span> u32 match ip dst <span class="nv">$ip</span> flowid 2:1
</span></span><span class="line"><span class="cl">    <span class="c1"># 在 1:1 节点添加一个过滤规则 , 优先权 1: 凡是去往目的地址是 $ip( 精确匹配 ) 的 IP 数据包 , 发送到频道 2:1.</span>
</span></span><span class="line"><span class="cl">    tc qdisc add dev <span class="nv">$interface</span> parent 1:1 handle 2: netem delay <span class="nv">$delay</span> loss <span class="nv">$loss</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><a href="https://github.com/magnific0/wondershaper">wondershaper</a></p>
</blockquote>
<h3 id="netstat">netstat</h3>
<blockquote>
<p>相关 <a href="#iproute2">iproute2</a></p>
</blockquote>
<ul>
<li>
<p><code>netstat -tunlp | grep 端口号</code> 用于查看指定的端口号的进程情况</p>
</li>
<li>
<p>参数</p>
<ul>
<li><code>-p</code> 显示建立相关连接的程序名和PID <strong>需要root</strong></li>
<li><code>-a</code> 显示本机所有连接和监听端口</li>
<li><code>-n</code> 以网络IP地址的形式显示当前建立的有效连接和端口</li>
<li><code>-r</code> 显示路由表信息</li>
<li><code>-s</code> 显示协议的统计信息。</li>
<li><code>-v</code> 显示当前的有效连接</li>
<li><code>-t</code> 显示所有的TCP协议连接情况</li>
<li><code>-u</code> 显示所有的UDP协议连接情况</li>
<li><code>-c&lt;秒数&gt;</code> 后面跟的秒数，表示每个几秒就刷新一次显示</li>
<li><code>-i</code> 显示自动配置接口的状态</li>
<li><code>-l</code> 仅显示连接状态为“LISTEN”的服务的网络状态</li>
</ul>
</li>
<li>
<p><code>netstat -an|awk '/tcp/ {print $6}'|sort|uniq -c| sort -hr</code> 查看TCP状态和数量</p>
</li>
</ul>
<hr>
<h3 id="iproute2">iproute2</h3>
<blockquote>
<p>代替 netstat ifconfig 的强大工具 <a href="https://cloud.tencent.com/developer/article/1183389">基于iproute命令集配置Linux网络</a></p>
</blockquote>
<table>
<thead>
<tr>
<th style="text-align:left">用途</th>
<th style="text-align:left">net-tool</th>
<th style="text-align:left">iproute2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">地址和链路配置</td>
<td style="text-align:left">ifconfig</td>
<td style="text-align:left">ip addr/link</td>
</tr>
<tr>
<td style="text-align:left">路由表</td>
<td style="text-align:left">route</td>
<td style="text-align:left">ip route</td>
</tr>
<tr>
<td style="text-align:left">ARP表</td>
<td style="text-align:left">arp</td>
<td style="text-align:left">ip neigh</td>
</tr>
<tr>
<td style="text-align:left">VLAN</td>
<td style="text-align:left">vconfig</td>
<td style="text-align:left">ip link</td>
</tr>
<tr>
<td style="text-align:left">隧道</td>
<td style="text-align:left">iptunnel</td>
<td style="text-align:left">ip tunnel</td>
</tr>
<tr>
<td style="text-align:left">组播</td>
<td style="text-align:left">ipmaddr</td>
<td style="text-align:left">ip maddr</td>
</tr>
<tr>
<td style="text-align:left">统计</td>
<td style="text-align:left">netstat</td>
<td style="text-align:left">ss</td>
</tr>
</tbody>
</table>
<p><code>net-tools 和 iproute 对应关系</code></p>
<table>
<thead>
<tr>
<th style="text-align:left">作用</th>
<th style="text-align:left">net-tools用法</th>
<th style="text-align:left">iproute2用法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">展示本机所有网络接口</td>
<td style="text-align:left">ifconfig</td>
<td style="text-align:left">ip link</td>
</tr>
<tr>
<td style="text-align:left">开启/停止某个网络接口</td>
<td style="text-align:left">ifconfig ech0 up/down</td>
<td style="text-align:left">ip link set eth0 up/down</td>
</tr>
<tr>
<td style="text-align:left">给网络接口设置/删除IP</td>
<td style="text-align:left">ipconfig eth0 10.0.0.0.1/24 / ifconfig eth0 0</td>
<td style="text-align:left">ip addr add/del 10.0.0.1/24 dev eth0</td>
</tr>
<tr>
<td style="text-align:left">显示某个网络接口的IP</td>
<td style="text-align:left">ifconfig eth0</td>
<td style="text-align:left">ip addr show dev eth0</td>
</tr>
<tr>
<td style="text-align:left">显示路由表</td>
<td style="text-align:left">route -n</td>
<td style="text-align:left">ip route show</td>
</tr>
<tr>
<td style="text-align:left">添加删除默认网关</td>
<td style="text-align:left">route add/del default gw 192.168.1.2 eth0</td>
<td style="text-align:left">ip route add/del via 192.168.1.2 eth0 <br/> ip route replace default via 192.168.1.2 dev eth0</td>
</tr>
<tr>
<td style="text-align:left">添加ARP</td>
<td style="text-align:left">arp -s 192.168.1.100 00:0c:29:c5:5a:ed</td>
<td style="text-align:left">ip neigh add 192.168.1.100 lladdr 00:0c:29:c5:5a:ed dev eth0</td>
</tr>
<tr>
<td style="text-align:left">删除ARP</td>
<td style="text-align:left">arp -d 192.168.1.100</td>
<td style="text-align:left">ip neigh del 192.168.1.100 dev eth0</td>
</tr>
<tr>
<td style="text-align:left">展示套接字状态</td>
<td style="text-align:left">netstat -l</td>
<td style="text-align:left">ss -l</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>默认网关： 如果主机找不到转发规则， 就把数据包发给默认的网关(家用网络一般是路由器的ip)</p>
</li>
<li>
<p>增加/删除一条路由规则 <code>ip route add/del 192.168.2.0/24 via 192.168.1.254</code></p>
<ul>
<li>当使用 VPN 时，建立新的虚拟网卡 tun， 可以手动设置路由让指定ip走虚拟网卡 从而访问到VPN内局域网地址(网络号和真实网卡一样，默认会把数据包转发至本地局域网)</li>
</ul>
</li>
<li>
<p>设置网卡 eno1 MAC 地址<code>ip link set eno1 address b4:xx:xx</code></p>
</li>
<li>
<p>关闭 启用 <code>ifconfig name down/up</code></p>
</li>
<li>
<p>修改IP <code>ifconfig eth0 192.168.1.200/24</code></p>
</li>
</ul>
<hr>
<p><em>iproute-ss</em></p>
<blockquote>
<p><a href="http://www.ttlsa.com/linux-command/ss-replace-netstat/">参考: Linux网络状态工具ss命令使用详解</a></p>
</blockquote>
<ul>
<li>查看网络连接统计 <code>ss -s</code></li>
<li>查看打开的端口 <code>ss -l</code></li>
<li>查看打开的端口以及进程pid <code>ss -pl</code></li>
<li>查看所有socket连接 <code>ss -a</code></li>
<li>隧道术： 网络协议的数据包被封装在另一种网络协议的数据包之中 <code>这是VPN的技术理论基础</code></li>
<li>按指定端口过滤 <code>ss -at '( dport = :3308 )'</code></li>
</ul>
<hr>
<h3 id="nmap">nmap</h3>
<blockquote>
<p>按主机扫描端口</p>
</blockquote>
<blockquote>
<p><a href="http://aaaxiang000.blog.163.com/blog/static/2063491220113284325531/">参考博客</a></p>
</blockquote>
<ul>
<li>
<p>主机扫描</p>
<ul>
<li>nmap -sS 192.168.1.1   　//TCP、SYN扫描,使用最多，最快 <code>无参数扫描默认添加-sS参数</code></li>
<li>nmap -Pn 192.168.1.1  　 //当目标主机禁ping时使用，假设主机存活扫描端口（耗时长）</li>
<li>nmap -p- 192.168.1.1  　 //扫描目标主机全部端口</li>
<li>nmap -sP 192.168.1.1   　//只对目标进行ping检测，快速</li>
<li>nmap 192.168.1.1/24   　 //对网段进行扫描</li>
</ul>
</li>
<li>
<p>进阶用法</p>
<ul>
<li>nmap -V 192.168.1.1    //显示扫描细节</li>
<li>nmap -A 192.168.1.1    //综合扫描</li>
<li>nmap -sT 192.168.1.1   //进行tcp扫描</li>
<li>nmap -sU 192.168.1.1   //进行udp扫描</li>
<li>nmap -sV 192.168.1.1   //对目标上的服务程序版本进行扫描</li>
<li>nmap -T4 192.168.1.1   //设置扫描速度1~5</li>
<li>nmap -sn 192.168.1.1   //相比sP检验存活使用更多方式</li>
<li>nmap -O 192.168.1.1    //对目标主机的操作系统进行扫描（-A获得更多信息）</li>
<li>nmap &ndash;data-length:55 192.168.1.1 //添加垃圾数据避免nmap被识别</li>
<li>nmap -D IP1,IP2&hellip; IP   //发送参杂着假ip的数据包检测</li>
</ul>
</li>
<li>
<p>使用环境</p>
<ul>
<li>扫描网段存活IP：nmap -sP 192.168.1.1/24</li>
<li>扫描所有端口开放情况：nmap -sS -p 1-65535 192.168.1.1</li>
<li>当目标主机禁ping时：nmap -Pn 192.168.1.1</li>
<li>当目标可能存在waf拦截时：nmap -sS &ndash;data-length:55 192.168.1.1</li>
<li>尽可能收集目标主机信息：nmap -p 1-65535 -sV -A -V 192.168.1.1</li>
</ul>
</li>
</ul>
<blockquote>
<p>按端口扫描</p>
</blockquote>
<p>masscan<br>
Zmap <code>在千兆网卡状态下，45 分钟内扫描全网络 IPv4 地址</code></p>
<h3 id="netcat">netcat</h3>
<blockquote>
<p>sudo apt install netcat</p>
</blockquote>
<blockquote>
<p><a href="https://klose911.github.io/html/material/nc.html">Nc 命令</a></p>
</blockquote>
<ul>
<li>
<p>监听端口 <code>nc -l 11044</code></p>
<ul>
<li>建立连接 <code>nc 127.0.0.1 11044</code> 任一方退出 netcat 就终止了该连接</li>
</ul>
</li>
<li>
<p>端口扫描 <code>nc -z -v -n -w 2 127.0.0.1 20-33</code> 扫描22-33端口</p>
<ul>
<li>-z 一旦连接立马断开，不发送接收任何数据</li>
<li>-v 输出详细信息</li>
<li>-n 直接使用IP地址，不使用域名服务器来查询其域名</li>
<li>-w 设置连接超时时间 s</li>
<li>-u 使用UDP 默认缺省则是TCP</li>
</ul>
</li>
<li>
<p>连接开放的端口 <code>nc -v host port</code></p>
</li>
<li>
<p>传输文件</p>
<ul>
<li>服务端发送文件 <code>nc -v -l -p port &lt; temp_out.md</code></li>
<li>客户端接收文件 <code>nc -v -n host port &gt; temp_in.md</code></li>
<li><em>注意</em>  仅单次连接，传输完毕自动断开, 没有进度提示,大文件也不支持。也可以服务端接收文件客户端发，将 <code>&lt; &gt;</code> 互换即可</li>
</ul>
</li>
<li>
<p>传输文件夹</p>
<ul>
<li>服务端 <code>tar -cvPf - /root/book/ | nc -l 12345</code></li>
<li>客户端 <code>nc -n host port | tar -xvPf -</code></li>
<li>这是未压缩的， 压缩再加上参数即可 例如 <code>gzip -czvPf -xzvPf</code></li>
</ul>
</li>
</ul>
<blockquote>
<p><a href="https://brucetg.github.io/2018/05/03/%E5%A4%9A%E7%A7%8D%E5%A7%BF%E5%8A%BF%E5%8F%8D%E5%BC%B9shell/">多种姿势反弹shell | Brucetg&rsquo;s Blog</a></p>
</blockquote>
<h3 id="scp">scp</h3>
<blockquote>
<p>scp命令用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，认证用的是ssh 所以也能使用sshpass</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    -1：使用ssh协议版本1； 
</span></span><span class="line"><span class="cl">    -2：使用ssh协议版本2； 
</span></span><span class="line"><span class="cl">    -4：使用ipv4； 
</span></span><span class="line"><span class="cl">    -6：使用ipv6； 
</span></span><span class="line"><span class="cl">    -B：以批处理模式运行； 
</span></span><span class="line"><span class="cl">    -C：使用压缩； 
</span></span><span class="line"><span class="cl">    -F：指定ssh配置文件； 
</span></span><span class="line"><span class="cl">    -l：指定宽带限制； 
</span></span><span class="line"><span class="cl">    -o：指定使用的ssh选项； 
</span></span><span class="line"><span class="cl">    -i: 指定私钥文件
</span></span><span class="line"><span class="cl">    -P：指定远程主机的端口号； 
</span></span><span class="line"><span class="cl">    -p：保留文件的最后修改时间，最后访问时间和权限模式； 
</span></span><span class="line"><span class="cl">    -q：不显示复制进度； 
</span></span><span class="line"><span class="cl">    -r：以递归方式复制。
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>远程到本地 <code>scp root@10.10.10.10:/opt/soft/nginx-0.5.38.tar.gz /opt/soft/</code></li>
<li>本地到远程 <code>scp /opt/soft/nginx-0.5.38.tar.gz root@10.10.10.10:/opt/soft/scptest</code></li>
</ul>
<blockquote>
<p>注: scp rcp wget rsync 几种传输文件的方式</p>
</blockquote>
<h3 id="rsync">rsync</h3>
<blockquote>
<p>同步命令 (个人倾向于本地和远程， 书上称为源端和目的端)  <a href="http://man.linuxde.net/rsync">命令参数详解</a> | <a href="https://www.digitalocean.com/community/tutorials/how-to-use-rsync-to-sync-local-and-remote-directories-on-a-vps">本地和VPS0之间同步数据</a></p>
</blockquote>
<ul>
<li>
<p>同步到 <code>rsync file user@host:path</code> 上， 是将这里的file文件覆盖远程的目录下的file文件，不像git那样</p>
<ul>
<li>同步当前目录 将file 换成 `ls`</li>
<li>-t 不加该参数：不会同步文件的修改时间，采用的<code>quick check策略</code>。使用后：让修改时间也同步，如果修改时间一致，就不同步（它不考虑文件内容，这是个坑）。</li>
<li>-I 就能解决上面的问题，每个文件都进行同步，代价是速度慢</li>
<li>-v 输出更多信息 v可以多个，v越多输出的日志信息也越多</li>
<li>-r 文件夹递归同步，这种是采用<code>上面的I策略</code>的</li>
<li>-l 同步软链接文件，默认是忽略该类文件的</li>
<li>-L 同步软链接文件及其目标文件</li>
<li>-z 压缩数据，提高传输速度</li>
<li>-p 缺省该参数时，如果远程没有该文件，权限会和本地的文件一致， 如果远程已经有该文件，权限和本地的不同， 那么命令不作更改。使用参数后，就会让权限尽力保持一致</li>
<li>-a 这个命令等价于 -rlptgoD 归档选项，采用递归方式，尽可能保持各方面的一致，但是不能同步硬链接，得加上 <code>-H</code></li>
</ul>
</li>
<li>
<p>只要文件不一样，就会触发同步，该命令确保远程的是和本地的一致，本地的直接覆盖远程的</p>
</li>
<li>
<p>只要rsync命令对本地有读权限，对远程有写权限，就能确保目录是一致的</p>
</li>
<li>
<p>rsync只能以登录远程的账号来创建文件，它不可能将文件的组信息，用户信息也一致，除非是root用户可以做到</p>
</li>
</ul>
<p><strong>【其他特别参数】</strong></p>
<ul>
<li>
<p><code>--delete</code> 如果本地没有该文件 远程就会删掉</p>
<ul>
<li><code>--delete-exclude </code>删除远程指定的文件</li>
<li><code>--delete-after</code> 默认是先清理远程文件再同步，使用该选项就相反了先同步再删除需要删除文件</li>
<li>例如 <code>mkdir blackdir &amp;&amp; rsync -a --delete blackdir/ test/</code> 删除目录内大量小文件时相较rm速度更快</li>
</ul>
</li>
<li>
<p><code>--exclude</code> 排除掉某些文件不同步 可以使用多次</p>
<ul>
<li><code>--excule-from</code> 如果要排除的文件很多，可以将文件名放在一个文本文件里，然后使用该选项读取该文件</li>
</ul>
</li>
<li>
<p><code>--partial</code> 断点续传 可以简写-P</p>
</li>
<li>
<p><code>--progress</code> 显示传输进度信息</p>
</li>
</ul>
<hr>
<h3 id="curl">curl</h3>
<blockquote>
<p><a href="https://curl.haxx.se/">Official site</a></p>
</blockquote>
<ol>
<li>不输出，重定向到<em>黑洞设备</em>  <code> curl -s -o /dev/null URL</code></li>
<li>使用基础认证 发送JSON数据 <code>curl -i -H &quot;Content-Type:application/json&quot; -u admin:secret -X POST --data '{&quot;title&quot;:&quot;1&quot;,&quot;content&quot;:&quot;1&quot;}' http://tomcat.kcp/email/content</code>
<ul>
<li>如果没有认证则会收到 401 返回码</li>
</ul>
</li>
</ol>
<ul>
<li>使用Cookie <code>curl -v --cookie &quot;USER_TOKEN=Yes&quot; http://127.0.0.1:5000/</code></li>
<li>使用代理  <code>-x, --proxy [protocol://]host[:port]</code></li>
<li>设置 Header <code>-H &quot;xxx:xxx&quot;</code> 例如 <code>-H &quot;Content-Type:application/json&quot; -H &quot;token:xxx&quot;</code></li>
<li>设置POST请求 body <code>-d '{&quot;title&quot;:&quot;1&quot;,&quot;content&quot;:&quot;1&quot;}'</code>
<ul>
<li>本地文件 <code>-d '@data.json'</code></li>
</ul>
</li>
<li>上传文件 <code>curl -X POST -H &quot;Content-Type: multipart/form-data&quot; -F &quot;file=@index.html&quot; URL</code></li>
</ul>
<blockquote>
<p><a href="http://www.cnblogs.com/wainiwann/p/3492939.html">参考: curl返回常见错误码</a></p>
</blockquote>
<ul>
<li><a href="https://stackoverflow.com/questions/10285700/curl-error-recv-failure-connection-reset-by-peer-php-curl">56错误码</a></li>
</ul>
<blockquote>
<p><a href="http://www.cnblogs.com/seasonzone/p/7527218.html">参考: 使用cURL和用户名和密码？</a></p>
</blockquote>
<ul>
<li>httpie <code>python</code></li>
<li>curlie</li>
<li><a href="https://github.com/astaxie/bat">bat</a> <code>go</code></li>
<li><a href="https://github.com/ducaale/xh">xh</a><code>rust</code></li>
<li><a href="https://github.com/Orange-OpenSource/hurl">hurl</a><code>rust</code> IDEA中Http插件一样，按HTTP协议写脚本 hurl运行</li>
</ul>
<hr>
<h3 id="wget">wget</h3>
<blockquote>
<p>特性和优势：支持 HTTP HTTPS FTP协议</p>
<ol>
<li>能够跟踪 HTML 和 XHTML 即可以下载整站，但是注意wget会不停的去下载HTML中的外链，无休无止</li>
<li>遵守 robots.txt 标准的工具</li>
<li>支持慢速网路和不稳定的下载，当下载失败就会不断重试，直到下载成功</li>
<li>支持断点续传</li>
</ol>
</blockquote>
<ul>
<li>
<p>wget 配置文件 <code>/etc/wgetrc</code> <code>~/.wgetrc</code> 两个文件配置（区别是全局和当前用户）wget的默认行为</p>
</li>
<li>
<p>例如 -X配置：<code>wget  -X js,css URL</code> 排除两个文件夹不下载</p>
<ul>
<li>如果要默认排除，到<code>.wgetrc</code>文件里配置 <code>exclude_directories=js,css</code></li>
<li>这时候就出了一个问题，你不知道配置文件的情况时，发现总有目录下载不下来，就可以排除两个文件的作用：</li>
<li><code>wget -X '' -X js,css URL</code></li>
<li>注意：<code>-X</code>，两个配置文件。这三者的配置，wget是取并集的， 使用了<code>-X ''</code> 后就只看后面的<code>-X 参数</code></li>
</ul>
</li>
<li>
<p>参数:</p>
<ul>
<li>
<p>目录下载 <code>-r</code> 递归选项</p>
</li>
<li>
<p>后台下载 <code>--background</code> 即使 你Ctrl D/exit也不会中断执行</p>
</li>
<li>
<p><code>-o</code> 指定日志输出。默认当前目录的 wget-log</p>
</li>
<li>
<p><code>--content-disposition</code> 支持HTTP Content-Disposition标头，通常包含文件名信息</p>
</li>
<li>
<p><code>-O</code> 将下载的所有文件的内容追加到指定的文件</p>
</li>
<li>
<p><code>-c</code> 断点续传 但是有潜在问题, 例如当源站的文件头部分或者已下载部分修改了，但wget只从上次下载的进度开始继续下载</p>
</li>
<li>
<p>避开robots.txt 协议 <code>--execute robots=off</code></p>
<ul>
<li>尝试使用 Tomcat 构建一个有robots协议的网站，然后wget还是绕过了协议</li>
<li>对 Github 测试这个参数是正常的</li>
</ul>
</li>
<li>
<p>简化wget获取到的文件</p>
<ul>
<li>-nH 去除wget将域名作为文件夹的情况,只得到域名下相对路径的文件</li>
<li>&ndash;cut-dirs=number 去除前缀路径</li>
<li>只用 <code>-r</code> : URL:a/b/c/</li>
<li><code>-r</code> 再用上 <code>--cut-dirs=1</code> : URL:/b/c/</li>
<li><code>-r</code> 再用上 <code>-nH</code> :a/b/c/</li>
<li><code>-r</code> 再用上 <code>-nH --cut-dirs=1</code> : /b/c/</li>
<li><code>-r</code> 再用上 <code>-nH --cut-dirs=2</code> : /c/</li>
</ul>
</li>
<li>
<p>平铺,不使用源站的目录结构: <code>-nd</code> 若有重名文件,自动重命名</p>
</li>
<li>
<p>强制多层次文件夹 <code>-x</code> 例如:github.com/a/b/ &ndash;&gt; github/com/a/b/</p>
</li>
<li>
<p>协议命名的根文件夹 <code>--protocol-directories</code> 例如 <a href="ftp://baidu.com/a/b/">ftp://baidu.com/a/b/</a></p>
</li>
<li>
<p>自动重试 <code>--tries=number</code> 设置下载失败后重试的次数</p>
</li>
<li>
<p>拒绝重复下载同名文件,即使这个文件不是最新的 <code>-nc</code>, wget会先比较时间戳,然后下载,且多次下载同名文件会自动添加 .1 .2 这样的后缀</p>
</li>
<li>
<p>自动分析是否下载同名文件, <code>-N</code> 会考虑时间戳以及文件大小,但是不能和 -nc 同时设置</p>
</li>
<li>
<p>限速 <code>--limit-rate=N</code> 默认单位是b,可以指定单位 k m</p>
<ul>
<li>这个限速的实现原理是通过在进行一次网络读取后,就线程睡眠一会儿,将速度降下来,如果下载是超小文件就可能无法达到限速的效果</li>
</ul>
</li>
<li>
<p>限制频率 -w 即 <code>--wait=seconds</code> 可以指定 m h d 等单位,效果是每两个请求间隔指定时间</p>
</li>
<li>
<p>请求重试 <code>--waitretry</code> 设置请求重试的秒数, 如果设置的是10秒, 第一次失败后就会等1s,然后第二次失败就等2s&hellip;直到递增到10s,然后结束</p>
<ul>
<li>其效果 其实应该是 设置值的累加 (理解为重试次数似乎更好)</li>
</ul>
</li>
</ul>
</li>
</ul>
<blockquote>
<p><a href="http://blog.csdn.net/adream307/article/details/47379149">wget cookie</a><br>
<a href="http://blog.csdn.net/RichardYSteven/article/details/4565931">参考: wget命令详解</a></p>
</blockquote>
<ul>
<li>
<p>镜像整站 <code>wget --mirror -p --convert-links -P . URL</code></p>
<ul>
<li>–miror: 镜像下载</li>
<li>-p: 下载所有为了html页面显示正常的文件</li>
<li>–convert-links: 下载后，转换成本地的链接</li>
<li><code>-P .</code>： 保存所有文件和目录 到当前目录</li>
</ul>
</li>
<li>
<p>镜像SPA等使用了前端动态路由的网站 <code>wget --mirror -w 2 -p --html-extension --tries=3 -k -P stackperl.html &quot;https://docs.egret.com/uieditor/docs/api/eui/eui.AddItems&quot;</code></p>
<ul>
<li>但是下载后无法正常使用子页面，还需要web服务器处理应用动态路由到静态资源文件上去 有点麻烦</li>
<li><a href="https://stackoverflow.com/questions/400935/how-do-i-completely-mirror-a-web-page">参考: how-do-i-completely-mirror-a-web-page</a></li>
</ul>
</li>
<li>
<p>获取API返回数据 <code>wget -q url -O -</code></p>
</li>
</ul>
<hr>
<blockquote>
<p><a href="https://github.com/axel-download-accelerator/axel">axel</a><br>
<a href="https://github.com/aria2/aria2">aria2</a></p>
</blockquote>
<hr>
<h1 id="证书">证书</h1>
<h2 id="自签发证书">自签发证书</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">  <span class="c1">############ 证书颁发机构</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># CA机构私钥</span>
</span></span><span class="line"><span class="cl">  openssl genrsa -out ca.key <span class="m">2048</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># CA证书</span>
</span></span><span class="line"><span class="cl">  openssl req -x509 -new -key ca.key -out ca.crt
</span></span><span class="line"><span class="cl">  <span class="c1">############ 服务端</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># 生成服务端私钥</span>
</span></span><span class="line"><span class="cl">  openssl genrsa -out server.key <span class="m">2048</span>
</span></span><span class="line"><span class="cl">  <span class="c1"># 生成服务端证书请求文件</span>
</span></span><span class="line"><span class="cl">  openssl req -new -key server.key -out server.csr
</span></span><span class="line"><span class="cl">  <span class="c1"># 使用CA证书生成服务端证书  关于sha256，默认使用的是sha1，在新版本的chrome中会被认为是不安全的，因为使用了过时的加密算法。</span>
</span></span><span class="line"><span class="cl">  openssl x509 -req -sha256 -in server.csr -CA ca.crt -CAkey ca.key -CAcreateserial -days <span class="m">3650</span> -out server.crt    
</span></span><span class="line"><span class="cl">  <span class="c1"># 打包服务端的资料为pkcs12格式(非必要，只是换一种格式存储上一步生成的证书) 生成过程中，需要创建访问密码，请记录下来。</span>
</span></span><span class="line"><span class="cl">  openssl pkcs12 -export -in server.crt -inkey server.key -out server.pkcs12
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>Manjaro 导入自定义证书</p>
</blockquote>
<p>sudo trust anchor &ndash;store my-root.crt
sudo update-ca-trust</p>
<hr>
<h1 id="常用服务">常用服务</h1>
<h2 id="邮件服务器">邮件服务器</h2>
<p>postfix和devecot</p>
<hr>
<h2 id="ftp">FTP</h2>
<h3 id="客户端">客户端</h3>
<h4 id="命令行">命令行</h4>
<blockquote>
<p><a href="https://www.javatpoint.com/ftp-commands">FTP Commands</a></p>
</blockquote>
<p>Manjaro 中 ftp 命令来自 inetutils 包</p>
<ul>
<li>ftp ip port 完成登录.</li>
<li>进入交互式终端后 执行 ? 查看可执行的命令</li>
<li>注意下载二进制文件时，需要执行 binary 切换模式，否则会字符流下载二进制文件导致编码问题。</li>
</ul>
<h4 id="java">Java</h4>
<blockquote>
<p><a href="https://commons.apache.org/proper/commons-net/">Apache Commons Net</a></p>
</blockquote>
<h3 id="服务端">服务端</h3>
<blockquote>
<p><a href="https://hub.docker.com/r/atmoz/sftp/">sftp</a><br>
<a href="https://filezilla-project.org/">Filezilla</a><code>服务端&amp;客户端</code></p>
</blockquote>
<h4 id="ftpserver">ftpserver</h4>
<blockquote>
<p><a href="https://github.com/fclairamb/ftpserver">ftpserver</a><code>Golang</code></p>
</blockquote>
<h4 id="vsftpd">vsftpd</h4>
<ul>
<li><code>sudo apt-get install vsftpd -y</code></li>
<li><code>sudo systemctl start vsftpd.service</code></li>
<li>创建用户 <code>sudo useradd -d /home/uftp -s /bin/bash uftp</code></li>
<li>设置密码 <code>sudo passwd uftp</code></li>
<li>删除掉 pam.d 中 vsftpd，因为该配置文件会导致使用用户名登录 ftp 失败：<code>sudo rm /etc/pam.d/vsftpd</code></li>
<li>限制用户 uftp 只能通过 FTP 访问服务器，而不能直接登录服务器 <code>sudo usermod -s /sbin/nologin</code> uftp</li>
<li>修改配置文件 <code>sudo chmod a+w /etc/vsftpd.conf</code></li>
</ul>
<p><code>/etc/vsftpd.conf </code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    # 限制用户对主目录以外目录访问
</span></span><span class="line"><span class="cl">    chroot_local_user=YES
</span></span><span class="line"><span class="cl">    # 指定一个 userlist 存放允许访问 ftp 的用户列表
</span></span><span class="line"><span class="cl">    userlist_deny=NO
</span></span><span class="line"><span class="cl">    userlist_enable=YES
</span></span><span class="line"><span class="cl">    # 记录允许访问 ftp 用户列表
</span></span><span class="line"><span class="cl">    userlist_file=/etc/vsftpd.user_list
</span></span><span class="line"><span class="cl">    # 不配置可能导致莫名的530问题
</span></span><span class="line"><span class="cl">    seccomp_sandbox=NO
</span></span><span class="line"><span class="cl">    # 允许文件上传
</span></span><span class="line"><span class="cl">    write_enable=YES
</span></span><span class="line"><span class="cl">    # 使用utf8编码
</span></span><span class="line"><span class="cl">    utf8_filesystem=YES
</span></span></code></pre></td></tr></table>
</div>
</div><ol>
<li>新建文件 sudo touch /etc/vsftpd.user_list</li>
<li>修改权限 <code>sudo chmod a+w /etc/vsftpd.user_list</code></li>
<li>添加用户名 <code>uftp</code></li>
<li>设置用户目录只读 <code>sudo chmod a-w /home/common</code></li>
<li>新建公共目录 设置权限 <code>mkdir /home/common/public &amp;&amp; sudo chmod 777 -R /home/common/public</code></li>
<li>重启服务 <code>sudo systemctl restart vsftpd.service</code></li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">    $ sudo mkdir /home/common
</span></span><span class="line"><span class="cl">    $ sudo touch /home/common/welcome.txt
</span></span><span class="line"><span class="cl">    $ sudo useradd -d /home/common -s /bin/bash common
</span></span><span class="line"><span class="cl">    $ sudo passwd common
</span></span><span class="line"><span class="cl">    $ sudo rm /etc/pam.d/vsftpd
</span></span><span class="line"><span class="cl">    $ sudo usermod -s /sbin/nologin common
</span></span><span class="line"><span class="cl">    $ sudo chmod a+w /etc/vsftpd.conf
</span></span><span class="line"><span class="cl">    $ sudo vim /etc/vsftpd.conf
</span></span><span class="line"><span class="cl">    $ sudo vim /etc/vsftpd.user_list
</span></span><span class="line"><span class="cl">    $ sudo chmod a-w /home/common
</span></span><span class="line"><span class="cl">    $ sudo mkdir /home/common/public <span class="o">&amp;&amp;</span> sudo chmod <span class="m">777</span> -R /home/common/public
</span></span><span class="line"><span class="cl">    $ sudo systemctl restart vsftpd.service
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="ssh">SSH</h2>
<blockquote>
<p><a href="/Linux/Base/SSH.md">详细</a></p>
</blockquote>
<h2 id="telnet">Telnet</h2>
<blockquote>
<p><a href="http://www.linuxso.com/command/telnet.html">linux telnet命令参数</a><br>
<a href="http://www.cnblogs.com/peida/archive/2013/03/13/2956992.html">每天一个linux命令（58）：telnet命令</a></p>
</blockquote>
<ul>
<li>测试端口连通性 <code>telnet ip port</code> 如果端口开放则提示 Connected, 否则会提示 refused
<ul>
<li>netcat 具有同样效果 <code>nc -v -z -n ip port</code></li>
</ul>
</li>
</ul>
<h2 id="vpn">VPN</h2>
<h3 id="tuntap">tun/tap</h3>
<blockquote>
<p><a href="https://blog.csdn.net/bytxl/article/details/26586109">参考: linux下TUN/TAP虚拟网卡的使用</a></p>
</blockquote>
<p><code>TUN TAP 区别</code></p>
<blockquote>
<p>TUN</p>
</blockquote>
<ol>
<li>工作在IP层 第三层</li>
</ol>
<blockquote>
<p>TAP</p>
</blockquote>
<ol>
<li>工作在数据链路层，第二层</li>
</ol>
<h3 id="shadowsocks">shadowsocks</h3>
<p><em>服务端</em></p>
<ul>
<li>安装服务端<code>sudo pip install shadowsocks</code></li>
<li>启动服务<code>sudo ssserver -p 443 -k sd -m aes-256-cfb</code></li>
<li>后台运行<code>sudo ssserver -p 443 -k sd -m aes-256-cfb --user nobodu -d start</code></li>
<li>停止 <code>sudo ssserver -d stop</code></li>
<li>日志 <code>sudo less /var/log/shadowsocks.log</code></li>
</ul>
<p><em>客户端</em></p>
<ul>
<li><code>sudo vim /etc/ss.json</code></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl">    <span class="p">{</span> 
</span></span><span class="line"><span class="cl">	    <span class="nt">&#34;server&#34;</span><span class="p">:</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="nt">&#34;server_port&#34;</span><span class="p">:</span><span class="mi">443</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="nt">&#34;localport&#34;</span><span class="p">:</span><span class="mi">1080</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="nt">&#34;password&#34;</span><span class="p">:</span><span class="s2">&#34;password&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="nt">&#34;timeout&#34;</span><span class="p">:</span><span class="mi">600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">	    <span class="nt">&#34;method&#34;</span><span class="p">:</span><span class="s2">&#34;aes-256-cfb&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>sslocal -c /etc/ss/json</code></li>
<li>设置代理是1080端口即可</li>
</ul>
<h3 id="openvpn">OpenVPN</h3>
<blockquote>
<p><a href="https://wiki.archlinux.org/index.php/OpenVPN">arch wiki</a></p>
</blockquote>
<p>以下文件都在同一目录下</p>
<ol>
<li>服务端提供 ca 文件</li>
<li>配置文件 <code>connect.ovpn</code>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">    client
</span></span><span class="line"><span class="cl">    dev tun
</span></span><span class="line"><span class="cl">    proto tcp
</span></span><span class="line"><span class="cl">    remote IP PORT               # 服务端IP地址映射的公网IP地址 端口
</span></span><span class="line"><span class="cl">    resolv-retry infinite
</span></span><span class="line"><span class="cl">    nobind
</span></span><span class="line"><span class="cl">    persist-key
</span></span><span class="line"><span class="cl">    persist-tun
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ca ca.crt # ca 文件
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    auth-user-pass # 可选 password 文件
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    comp-lzo
</span></span><span class="line"><span class="cl">    verb 3
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>账户密码文件 <code>passwd</code>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">用户名
</span></span><span class="line"><span class="cl">密码
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>启动 sudo openvpn &ndash;daemon &ndash;cd /etc/openvpn/client &ndash;config connect.ovpn &ndash;auth-user-pass /etc/openvpn/client/passwd &ndash;log-append /path/to/log.log</li>
</ol>
<blockquote>
<p>ERROR: Cannot open TUN/TAP dev /dev/net/tun: No such device</p>
</blockquote>
<ol>
<li>modinfo tun 查看内核模块是否存在</li>
<li>尝试 sudo pacman -S networkmanager-vpnc 并重启</li>
</ol>
<h3 id="fortivpn">Fortivpn</h3>
<blockquote>
<p><a href="https://github.com/adrienverge/openfortivpn">openfortivpn</a>  对应于 <a href="https://fortinet.com/">fortinet.com</a> 的开源版本</p>
</blockquote>
<p><code>yay openfortivpn</code></p>
<ol>
<li>按官方文档新建配置文件 some_company.conf
<ul>
<li>填写正确的 host,port,username,password</li>
<li>注意: trusted-cert 可以用仓库Readme文档的值，通过报错信息获得公司内的证书，然后反向填入配置文件。。。
<ul>
<li>相比于官方的包 <code>forticlient-vpn</code> GUI配置完，不像Windows平台会提示导入证书，只有无尽的连接中。。</li>
</ul>
</li>
</ul>
</li>
<li>sudo openfortivpn -c some_company.conf</li>
<li>手动追加dns <code>sudo sed -i '1 i\nameserver x.x.x.x' /etc/resolv.conf</code> 注意 dns的ip会从运行中的输出 ns 部分</li>
</ol>
<hr>
<h2 id="代理">代理</h2>
<blockquote>
<p><a href="/Skills/Network/Network.md#%E4%BB%A3%E7%90%86-proxy">网络基础 </a></p>
</blockquote>
<h3 id="端口转发">端口转发</h3>
<blockquote>
<p><a href="https://github.com/eirture/tcp-proxy">eirture/tcp-proxy: A TCP proxy command line tool, written in Golang</a></p>
</blockquote>
<blockquote>
<p><a href="https://codeberg.org/gruf/tcpee">gruf/tcpee: simple multi-threaded TCP proxy in Go - Codeberg.org</a><code>注意proxy-proto设置为false可正常使用</code></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="p">[</span><span class="nx">example-name</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="nx">server-timeout</span> <span class="p">=</span> <span class="s2">&#34;300s&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">client-timeout</span> <span class="p">=</span> <span class="s2">&#34;300s&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">server-keepalive</span> <span class="p">=</span> <span class="s2">&#34;150s&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">client-keepalive</span> <span class="p">=</span> <span class="s2">&#34;150s&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">proxy</span> <span class="p">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;0.0.0.0:9868 -&gt; 192.168.56.10:3306&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="c"># Enable writing of v1 compatible</span>
</span></span><span class="line"><span class="cl">    <span class="c"># proxy protocol headers</span>
</span></span><span class="line"><span class="cl">    <span class="nx">proxy-proto</span> <span class="p">=</span> <span class="kc">false</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="proxychains">proxychains</h3>
<ul>
<li>安装
<ul>
<li><a href="https://github.com/rofl0r/proxychains-ng">编译安装</a></li>
<li>包管理器
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">sudo pacman -S community/proxychains-ng <span class="c1"># Arch</span>
</span></span><span class="line"><span class="cl">sudo apt install proxychains  <span class="c1"># apt</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>配置文件 <code>/etc/proxychains.conf</code>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[ProxyList]
</span></span><span class="line"><span class="cl"># add proxy here ...
</span></span><span class="line"><span class="cl"># meanwile
</span></span><span class="line"><span class="cl"># defaults set to &#34;tor&#34;
</span></span><span class="line"><span class="cl"># socks4        127.0.0.1 9050
</span></span><span class="line"><span class="cl"># socks5  127.0.0.1  1080
</span></span><span class="line"><span class="cl">http  127.0.0.1 7890
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="防火墙">防火墙</h2>
<h3 id="iptables">iptables</h3>
<blockquote>
<p><a href="http://www.cnblogs.com/JemBai/archive/2009/03/19/1416364.html">参考: linux下IPTABLES配置详解</a></p>
</blockquote>
<blockquote>
<p>其主要配置文件为: <code>/etc/sysconfig/iptables</code></p>
</blockquote>
<ul>
<li>
<p>查看配置情况 <code> iptables -L -n</code></p>
</li>
<li>
<p>开启/屏蔽 端口 <code>iptables -A INPUT -p tcp --dport 8000 -j ACCEPT</code></p>
<ul>
<li>-A 参数表示添加规则，此外-D表示删除规则</li>
<li>-p 表示协议，一般都是tcp</li>
<li>&ndash;dport 就是指定端口号</li>
<li>-j 指定 ACCEPT/DROP，接收还是抛弃</li>
</ul>
</li>
</ul>
<p><em>问题场景</em></p>
<ol>
<li>服务器的端口服务是正常启动的, 但是客户端连不上；使用curl 去访问那个端口, 报错说 curl: (7) Failed to connect to xxxx port 8080: 没有到主机的路由</li>
<li>curl 无响应</li>
</ol>
<h4 id="四层协议端口转发">四层协议端口转发</h4>
<p>可实现场景：公网内服务器访问内网A域名（Nginx配置）。<br>
实现方案为公网服务器追加A域名的DNS到内网出口机的公网ip，出口机配置任意端口转发并修改上层应用层的请求头从而实现Nginx无感差异的访问（Nginx能正常匹配路由）</p>
<hr>
<h2 id="远程桌面">远程桌面</h2>
<blockquote>
<p><a href="https://www.cnblogs.com/hw-1015/articles/5910969.html">参考: 连接Linux远程桌面的四个方法</a><br>
<a href="https://www.zhihu.com/question/20301978">参考: 你会在linux服务器上安装远程桌面吗？</a></p>
</blockquote>
<h3 id="vnc">VNC</h3>
<blockquote>
<p>Virtual Network Computing</p>
</blockquote>
<blockquote>
<p><a href="https://blog.csdn.net/ywueoei/article/details/79952727">参考: Ubuntu远程SSH及x11vnc远程桌面连接</a></p>
</blockquote>
<ol>
<li>
<p>服务端安装 <code>x11vnc</code></p>
</li>
<li>
<p>设置密码 <code>x11vnc -storepasswd</code></p>
</li>
<li>
<p>使用密码启动 <code>x11vnc -auth guess -once -loop -noxdamage -repeat -rfbauth ~/.vnc/passwd -rfbport 5900 -shared</code></p>
<ul>
<li>设置分辨率 <code>-geometry 1280×1024</code></li>
</ul>
</li>
<li>
<p>客户端 vnc-viewer(任意) 输入 ip 即可连接</p>
</li>
</ol>
<blockquote>
<p><a href="https://github.com/novnc/noVNC">noVNC</a> <code>VNC client web application</code></p>
</blockquote>
<hr>
<h3 id="xrdp">Xrdp</h3>
<blockquote>
<p><a href="https://www.linuxidc.com/Linux/2018-10/155073.htm">参考: Xrdp - 通过Windows的RDP连接Linux远程桌面</a></p>
</blockquote>
<hr>
<h1 id="tips">Tips</h1>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Kuangcp</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2018-12-15
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E5%9F%BA%E7%A1%80/">基础</a>
          <a href="/tags/%E7%BD%91%E7%BB%9C/">网络</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/linux/base/linuxperformance/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Linux性能分析</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/linux/base/linuxmanual/">
            <span class="next-text nav-default">Linux 命令手册</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/Kuangcp" class="iconfont icon-github" title="github"></a>
  <a href="https://www.kuangcp.top/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://gitee.com/gin9/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2016 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span>
    <span>Kuangcp</span>
    
    <br/><span><a href='http://beian.miit.gov.cn/'; target=_blank>赣ICP备17014189号</a></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>








</body>
</html>
