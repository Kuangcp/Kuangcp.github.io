<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>JVM ç›‘æ§&amp;è¯Šæ–­ - Mythos Â· Java Developer</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Kuangcp" /><meta name="description" content="ğŸ’  JVM ç›‘æ§&amp;amp;è¯Šæ–­ JVMTI JDKè‡ªå¸¦å·¥å…· 3.1. java 3.1.1. ç¯å¢ƒå˜é‡çš„ä½¿ç”¨ 3.2. jps 3.3. jstat 3.4. jinfo 3.5. jmap 3.6. jhat 3.6.1. OQL 3.6.2. HPROF 3.7. jstack 3.7.1. å®ç°åŸç† 3.8. jcmd 3.9. jhsdb ç»ˆç«¯ç±»å·¥å…· 4.1. Arthas 4.2. async-profiler jvm-sandbox å›¾å½¢åŒ–å·¥å…· 6.1." /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.99.0 with theme even" />


<link rel="canonical" href="https://www.kuangcp.top/post/java/advancedlearning/jvmtool/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="JVM ç›‘æ§&amp;è¯Šæ–­" />
<meta property="og:description" content="ğŸ’  JVM ç›‘æ§&amp;è¯Šæ–­ JVMTI JDKè‡ªå¸¦å·¥å…· 3.1. java 3.1.1. ç¯å¢ƒå˜é‡çš„ä½¿ç”¨ 3.2. jps 3.3. jstat 3.4. jinfo 3.5. jmap 3.6. jhat 3.6.1. OQL 3.6.2. HPROF 3.7. jstack 3.7.1. å®ç°åŸç† 3.8. jcmd 3.9. jhsdb ç»ˆç«¯ç±»å·¥å…· 4.1. Arthas 4.2. async-profiler jvm-sandbox å›¾å½¢åŒ–å·¥å…· 6.1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.kuangcp.top/post/java/advancedlearning/jvmtool/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2018-11-21T10:56:52+00:00" />
<meta property="article:modified_time" content="2018-11-21T10:56:52+00:00" />

<meta itemprop="name" content="JVM ç›‘æ§&amp;è¯Šæ–­">
<meta itemprop="description" content="ğŸ’  JVM ç›‘æ§&amp;è¯Šæ–­ JVMTI JDKè‡ªå¸¦å·¥å…· 3.1. java 3.1.1. ç¯å¢ƒå˜é‡çš„ä½¿ç”¨ 3.2. jps 3.3. jstat 3.4. jinfo 3.5. jmap 3.6. jhat 3.6.1. OQL 3.6.2. HPROF 3.7. jstack 3.7.1. å®ç°åŸç† 3.8. jcmd 3.9. jhsdb ç»ˆç«¯ç±»å·¥å…· 4.1. Arthas 4.2. async-profiler jvm-sandbox å›¾å½¢åŒ–å·¥å…· 6.1."><meta itemprop="datePublished" content="2018-11-21T10:56:52+00:00" />
<meta itemprop="dateModified" content="2018-11-21T10:56:52+00:00" />
<meta itemprop="wordCount" content="3585">
<meta itemprop="keywords" content="JVM," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="JVM ç›‘æ§&amp;è¯Šæ–­"/>
<meta name="twitter:description" content="ğŸ’  JVM ç›‘æ§&amp;è¯Šæ–­ JVMTI JDKè‡ªå¸¦å·¥å…· 3.1. java 3.1.1. ç¯å¢ƒå˜é‡çš„ä½¿ç”¨ 3.2. jps 3.3. jstat 3.4. jinfo 3.5. jmap 3.6. jhat 3.6.1. OQL 3.6.2. HPROF 3.7. jstack 3.7.1. å®ç°åŸç† 3.8. jcmd 3.9. jhsdb ç»ˆç«¯ç±»å·¥å…· 4.1. Arthas 4.2. async-profiler jvm-sandbox å›¾å½¢åŒ–å·¥å…· 6.1."/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Mythos</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Mythos</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">JVM ç›‘æ§&amp;è¯Šæ–­</h1>

      <div class="post-meta">
        <span class="post-time"> 2018-11-21 </span>
        <div class="post-category">
            <a href="/categories/java/"> Java </a>
            <a href="/categories/troubleshoot/"> Troubleshoot </a>
            </div>
          <span class="more-meta"> 3585 words </span>
          <span class="more-meta"> 8 mins read </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#jvm-ç›‘æ§è¯Šæ–­">JVM ç›‘æ§&amp;è¯Šæ–­</a></li>
    <li><a href="#jvmti">JVMTI</a></li>
    <li><a href="#jdkè‡ªå¸¦å·¥å…·">JDKè‡ªå¸¦å·¥å…·</a>
      <ul>
        <li><a href="#java">java</a>
          <ul>
            <li><a href="#ç¯å¢ƒå˜é‡çš„ä½¿ç”¨">ç¯å¢ƒå˜é‡çš„ä½¿ç”¨</a></li>
          </ul>
        </li>
        <li><a href="#jps">jps</a></li>
        <li><a href="#jstat">jstat</a></li>
        <li><a href="#jinfo">jinfo</a></li>
        <li><a href="#jmap">jmap</a></li>
        <li><a href="#jhat">jhat</a>
          <ul>
            <li><a href="#oql">OQL</a></li>
            <li><a href="#hprof">HPROF</a></li>
          </ul>
        </li>
        <li><a href="#jstack">jstack</a>
          <ul>
            <li><a href="#å®ç°åŸç†">å®ç°åŸç†</a></li>
          </ul>
        </li>
        <li><a href="#jcmd">jcmd</a></li>
        <li><a href="#jhsdb">jhsdb</a></li>
      </ul>
    </li>
    <li><a href="#ç»ˆç«¯ç±»å·¥å…·">ç»ˆç«¯ç±»å·¥å…·</a>
      <ul>
        <li><a href="#arthas">Arthas</a></li>
        <li><a href="#async-profiler">async-profiler</a></li>
      </ul>
    </li>
    <li><a href="#jvm-sandbox">jvm-sandbox</a></li>
    <li><a href="#å›¾å½¢åŒ–å·¥å…·">å›¾å½¢åŒ–å·¥å…·</a>
      <ul>
        <li><a href="#jprofiler">JProfiler</a></li>
        <li><a href="#yourkit">YourKit</a></li>
        <li><a href="#visualvm">Visualvm</a></li>
        <li><a href="#mat">MAT</a></li>
        <li><a href="#jmc">JMC</a>
          <ul>
            <li><a href="#jfr">JFR</a></li>
          </ul>
        </li>
        <li><a href="#ibm-heap-analyzer">IBM Heap Analyzer</a></li>
        <li><a href="#intellij-idea">IntelliJ IDEA</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p>ğŸ’ </p>
<ul>
<li>
<ol>
<li><a href="#jvm-%E7%9B%91%E6%8E%A7&amp;%E8%AF%8A%E6%96%AD">JVM ç›‘æ§&amp;è¯Šæ–­</a></li>
</ol>
</li>
<li>
<ol start="2">
<li><a href="#jvmti">JVMTI</a></li>
</ol>
</li>
<li>
<ol start="3">
<li><a href="#jdk%E8%87%AA%E5%B8%A6%E5%B7%A5%E5%85%B7">JDKè‡ªå¸¦å·¥å…·</a></li>
</ol>
<ul>
<li>3.1. <a href="#java">java</a>
<ul>
<li>3.1.1. <a href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8">ç¯å¢ƒå˜é‡çš„ä½¿ç”¨</a></li>
</ul>
</li>
<li>3.2. <a href="#jps">jps</a></li>
<li>3.3. <a href="#jstat">jstat</a></li>
<li>3.4. <a href="#jinfo">jinfo</a></li>
<li>3.5. <a href="#jmap">jmap</a></li>
<li>3.6. <a href="#jhat">jhat</a>
<ul>
<li>3.6.1. <a href="#oql">OQL</a></li>
<li>3.6.2. <a href="#hprof">HPROF</a></li>
</ul>
</li>
<li>3.7. <a href="#jstack">jstack</a>
<ul>
<li>3.7.1. <a href="#%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86">å®ç°åŸç†</a></li>
</ul>
</li>
<li>3.8. <a href="#jcmd">jcmd</a></li>
<li>3.9. <a href="#jhsdb">jhsdb</a></li>
</ul>
</li>
<li>
<ol start="4">
<li><a href="#%E7%BB%88%E7%AB%AF%E7%B1%BB%E5%B7%A5%E5%85%B7">ç»ˆç«¯ç±»å·¥å…·</a></li>
</ol>
<ul>
<li>4.1. <a href="#arthas">Arthas</a></li>
<li>4.2. <a href="#async-profiler">async-profiler</a></li>
</ul>
</li>
<li>
<ol start="5">
<li><a href="#jvm-sandbox">jvm-sandbox</a></li>
</ol>
</li>
<li>
<ol start="6">
<li><a href="#%E5%9B%BE%E5%BD%A2%E5%8C%96%E5%B7%A5%E5%85%B7">å›¾å½¢åŒ–å·¥å…·</a></li>
</ol>
<ul>
<li>6.1. <a href="#jprofiler">JProfiler</a></li>
<li>6.2. <a href="#yourkit">YourKit</a></li>
<li>6.3. <a href="#visualvm">Visualvm</a></li>
<li>6.4. <a href="#mat">MAT</a></li>
<li>6.5. <a href="#jmc">JMC</a>
<ul>
<li>6.5.1. <a href="#jfr">JFR</a></li>
</ul>
</li>
<li>6.6. <a href="#ibm-heap-analyzer">IBM Heap Analyzer</a></li>
<li>6.7. <a href="#intellij-idea">IntelliJ IDEA</a></li>
</ul>
</li>
</ul>
<p>ğŸ’  2025-04-19 19:25:00</p>
<hr>
<h1 id="jvm-ç›‘æ§è¯Šæ–­">JVM ç›‘æ§&amp;è¯Šæ–­</h1>
<p>å‘½ä»¤è¡Œç»ˆç«¯</p>
<ul>
<li>æ ‡å‡†ç»ˆç«¯ç±»ï¼šjpsã€jinfoã€jstatã€jstackã€jmap</li>
<li>åŠŸèƒ½æ•´åˆç±»ï¼šjcmdã€vjtoolsã€arthasã€greys</li>
</ul>
<p>å¯è§†åŒ–ç•Œé¢</p>
<ul>
<li>ç®€æ˜“ï¼šJConsoleã€JVisualvmã€HAã€GCHistoã€GCViewer</li>
<li>è¿›é˜¶ï¼šMATã€JProfiler</li>
</ul>
<p>å‘½ä»¤è¡Œæ¨è arthas ï¼Œå¯è§†åŒ–ç•Œé¢æ¨è JProfiler<br>
æ­¤å¤–è¿˜æœ‰ä¸€äº›åœ¨çº¿çš„å¹³å° <a href="https://gceasy.io/">gceasy</a>ã€heapheroã€fastthread ã€‚</p>
<blockquote>
<p><a href="https://github.com/aragozin/jvm-tools">jvm-tools</a></p>
</blockquote>
<h1 id="jvmti">JVMTI</h1>
<p><code>JVM Tool Interface</code></p>
<h1 id="jdkè‡ªå¸¦å·¥å…·">JDKè‡ªå¸¦å·¥å…·</h1>
<blockquote>
<p>éƒ½æ˜¯jdkçš„binç›®å½•ä¸‹çš„å·¥å…·ï¼Œæ³¨æ„ä½¿ç”¨æ—¶è¦å’Œç›®æ ‡JVMåŒä¸€ä¸ªJDKç‰ˆæœ¬ï¼Œä»¥åŠåŒä¸€ä¸ªç”¨æˆ·ï¼Œè¡ç”Ÿçš„å·¥å…·å¦‚Arthasç­‰ç­‰åŒç†ã€‚</p>
</blockquote>
<h2 id="java">java</h2>
<blockquote>
<p>ä½¿ç”¨æ–¹å¼ï¼š</p>
</blockquote>
<ul>
<li>æ‰§è¡Œç±»ï¼š <code>java [-options] class [args...]</code></li>
<li>æ‰§è¡ŒåŒ…ï¼š <code>java [-options] -jar jarfile [args...]</code> æˆ– <code>java -jar [-options] jarfile [args...]</code></li>
</ul>
<blockquote>
<p><strong>æ³¨æ„</strong> è¿™äº›Java optionséƒ½<em>ä¸ä¼š</em>ç”Ÿæ•ˆã€‚
<code>java -jar jarfile [-options] [args...]</code><br>
<code>java -jar jarfile [args...] [-options]</code></p>
</blockquote>
<h3 id="ç¯å¢ƒå˜é‡çš„ä½¿ç”¨">ç¯å¢ƒå˜é‡çš„ä½¿ç”¨</h3>
<blockquote>
<p><a href="https://coderanch.com/t/178539/certification/java-command-line-option-good">What is the java -D command-line option good for? </a></p>
</blockquote>
<ul>
<li>ä¼ å…¥ <code>java -Dkey=true -jar xxx.jar</code>
<ul>
<li>-D å‚æ•° è¦åœ¨ -jar <strong>ä¹‹å‰</strong></li>
</ul>
</li>
<li>è·å– <code>System.getProperty(&quot;key&quot;, &quot;defaultvalue&quot;);</code></li>
</ul>
<h2 id="jps">jps</h2>
<blockquote>
<p>ä¸»è¦ç”¨æ¥è¾“å‡ºJVMä¸­è¿è¡Œçš„è¿›ç¨‹çŠ¶æ€ä¿¡æ¯</p>
</blockquote>
<ul>
<li>option:
<ul>
<li>-q å¿½ç•¥è¾“å‡ºçš„ç±»åã€Jaråä»¥åŠä¼ é€’ç»™mainæ–¹æ³•çš„å‚æ•°ï¼Œåªè¾“å‡ºpidã€‚</li>
<li>-m è¾“å‡ºä¼ é€’ç»™mainæ–¹æ³•çš„å‚æ•°ï¼Œå¦‚æœæ˜¯å†…åµŒçš„JVMåˆ™è¾“å‡ºä¸ºnullã€‚</li>
<li>-l è¾“å‡ºåº”ç”¨ç¨‹åºä¸»ç±»çš„å®Œæ•´åŒ…åï¼Œæˆ–è€…æ˜¯åº”ç”¨ç¨‹åºJARæ–‡ä»¶çš„å®Œæ•´è·¯å¾„ã€‚</li>
<li>-v è¾“å‡ºä¼ ç»™JVMçš„å‚æ•°ã€‚</li>
<li>-V è¾“å‡ºé€šè¿‡æ ‡è®°çš„æ–‡ä»¶ä¼ é€’ç»™JVMçš„å‚æ•°ï¼ˆ.hotspotrcæ–‡ä»¶ï¼Œæˆ–è€…æ˜¯é€šè¿‡å‚æ•°-XX:Flags=æŒ‡å®šçš„æ–‡ä»¶ï¼‰</li>
</ul>
</li>
</ul>
<h2 id="jstat">jstat</h2>
<blockquote>
<p><a href="https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jstat.html">Oracle Docï¼š jstat</a></p>
</blockquote>
<ul>
<li>option:
<ul>
<li>-class ç±»åŠ è½½æƒ…å†µ</li>
<li>-compiler ç¼–è¯‘ç»Ÿè®¡</li>
<li>-printcompilation JVMç¼–è¯‘æ–¹æ³•ç»Ÿè®¡</li>
<li>æŸ¥çœ‹å†…å­˜ç›¸å…³æŒ‡æ ‡
<ul>
<li><code>-gcutil</code> æ€»gcç»Ÿè®¡æƒ…å†µ</li>
<li><code>-gc</code> gcç»Ÿè®¡æƒ…å†µ</li>
<li><code>-gccapacity</code> å †å†…å­˜ç©ºé—´</li>
<li><code>-gcnew</code> å’Œ <code>-gcnewcapacity</code> æ–°ç”Ÿä»£gcå’Œå†…å­˜ç»Ÿè®¡</li>
<li><code>-gcold</code> å’Œ <code>-gcoldcapacity</code> è€å¹´ä»£gcå’Œå†…å­˜ç»Ÿè®¡</li>
<li><code>-gcpermcapacity</code> JDK7 æ°¸ä¹…ä»£</li>
<li><code>-gcmetacapacity</code> JDK8 å…ƒç©ºé—´</li>
</ul>
</li>
<li>-t åœ¨ç¬¬ä¸€åˆ—è¾“å‡ºæ—¶é—´æˆ³<code>(s)</code>ã€‚è¯¥æ—¶é—´æˆ³ä»jvmå¯åŠ¨åå¼€å§‹è®¡æ—¶</li>
<li>-h3 æ¯éš”Nè¡Œè¾“å‡ºä¸€æ¬¡åˆ—è¡¨å¤´</li>
<li>$PID è¿›ç¨‹å·</li>
<li>interval è¾“å‡ºé—´éš”æ—¶é—´ï¼Œå•ä½æ¯«ç§’</li>
<li>count è¾“å‡ºæ¬¡æ•°</li>
</ul>
</li>
</ul>
<blockquote>
<p><a href="https://blog.csdn.net/achuo/article/details/107793361">CSDN: jstat</a></p>
</blockquote>
<blockquote>
<p>Demo:</p>
</blockquote>
<ul>
<li><code>jstat -gcutil -t -h5 7919 1000 50</code></li>
</ul>
<h2 id="jinfo">jinfo</h2>
<blockquote>
<p>è§‚å¯Ÿè¿è¡Œä¸­çš„ java è¿›ç¨‹çš„è¿è¡Œç¯å¢ƒå‚æ•°ï¼šå‚æ•°åŒ…æ‹¬ Java System å±æ€§å’Œ JVM å‘½ä»¤è¡Œå‚æ•°</p>
</blockquote>
<blockquote>
<p>Demo:</p>
</blockquote>
<ul>
<li>jinfo 14352</li>
<li>jinfo -sysprops 14352</li>
<li>æŸ¥çœ‹JVMå‚æ•° <code>jinfo -flags 14352</code>
<ul>
<li>jinfo -flag MaxPermSize 14352</li>
</ul>
</li>
</ul>
<h2 id="jmap">jmap</h2>
<blockquote>
<p>ç”¨æ¥æŸ¥çœ‹å †å†…å­˜ä½¿ç”¨çŠ¶å†µ</p>
</blockquote>
<blockquote>
<p>Demo:</p>
</blockquote>
<ul>
<li><code>jmap -histo $PID</code> å±•ç¤ºå®ä¾‹å’Œå ç”¨å†…å­˜æƒ…å†µ
<ul>
<li><code>jmap -histo:live $PID</code> å±•ç¤ºå­˜æ´»å®ä¾‹æƒ…å†µ <strong>æ³¨æ„ä¼šè§¦å‘FullGC</strong></li>
</ul>
</li>
<li><code>jmap -heap $PID</code> å±•ç¤ºJavaå †çš„å„å†…å­˜åŒºåŸŸå¤§å°åŠå ç”¨æƒ…å†µ</li>
<li><code>jmap -dump:live,format=b,file=heapLive.hprof $PID</code> dumpä¸‹å­˜æ´»å¯¹è±¡  <strong>æ³¨æ„ä¼šè§¦å‘FullGC</strong>
<ul>
<li><code>jmap -dump:format=b,file=heapLive.hprof $PID</code> dumpæ‰€æœ‰å¯¹è±¡</li>
<li>å¤±è´¥æ—¶ å¯ä»¥å°è¯• -F å‚æ•°ï¼Œå¼ºåˆ¶dumpï¼Œä½†æ­¤æ—¶çš„dumpæ–‡ä»¶ä¸ä¸€å®šæ˜¯å®Œæ•´å¯æ‰“å¼€çš„ã€‚</li>
<li>æç¤ºattachå¤±è´¥æ—¶ å¯ä¿®æ”¹ <code>echo 0 &gt; /proc/sys/kernel/yama/ptrace_scope</code>  jmapä¾èµ–ptraceå®ç°ï¼Œæ­¤é€‰é¡¹æ”¾å¼€ptraceä»…æ”¯æŒçˆ¶è¿›ç¨‹æ‰§è¡Œçš„é™åˆ¶</li>
</ul>
</li>
</ul>
<p>æ³¨æ„ centos7.9é‡Œï¼Œå¦‚æœå½“å‰ç”¨æˆ·åœ¨æ²¡æœ‰æƒé™çš„ç›®å½•ä¸‹æ‰§è¡Œdumpå‘½ä»¤ <strong>ä½çº§å¤±è¯¯</strong></p>
<ul>
<li>å°†é»˜è®¤åˆ›å»ºåœ¨ /tmp/hsperfdata_username/ ç›®å½•ä¸‹ï¼Œç”±äºtmpçš„æ¸…ç†ç‰¹æ€§ï¼Œéšæ—¶ä¼šä¸¢å¤±ã€‚</li>
</ul>
<hr>
<h2 id="jhat">jhat</h2>
<blockquote>
<p>Java Head Analyse Tool <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/troubleshoot/tooldescr012.html">Oracle: jhat</a></p>
</blockquote>
<p>ç”¨äºåˆ†æ jmap è½¬å‚¨å‡ºæ¥çš„å †æ–‡ä»¶, åˆ†æå®Œåå¯åŠ¨ä¸€ä¸ªWebServerï¼Œ æµè§ˆå™¨æ‰“å¼€ 127.0.0.1:7000 æŸ¥çœ‹</p>
<blockquote>
<p>å‚æ•°</p>
</blockquote>
<ul>
<li>-J-mx2g è®¾ç½®æœ€å¤§å†…å­˜2g</li>
<li>-J-d64 64ä½æ¨¡å¼</li>
<li>-port ç«¯å£</li>
</ul>
<blockquote>
<p>ä½¿ç”¨</p>
</blockquote>
<ul>
<li>ç½‘é¡µ
<ul>
<li>é¦–é¡µ æ‰€æœ‰ç±»ï¼Œç‚¹å‡»å¯æŸ¥çœ‹ç±»çš„å®ä¾‹åˆ—è¡¨</li>
<li>åº•éƒ¨ Other Queries åŒ…å«ï¼š histoï¼ŒOQLæŸ¥è¯¢ï¼Œç±»å®ä¾‹ æŸ¥çœ‹åŠŸèƒ½</li>
</ul>
</li>
<li>æ¯”è¾ƒå¤šä¸ªdump <code>jhat -baseline snapshot_1.hprof snapshot_2.hprof</code> 1ï¼Œ2æ–‡ä»¶æ˜¯å…ˆådumpäº§ç”Ÿçš„
<ul>
<li>åœ¨åº•éƒ¨çš„ç±»å®ä¾‹<code>Show instance counts</code> ä¸­èƒ½çœ‹åˆ°å¤šäº†ä¸€åˆ— ä¾‹å¦‚ <code>instances (111060 new) of class</code></li>
</ul>
</li>
<li><a href="http://localhost:7000/oql/">OQLæŸ¥è¯¢</a>
<ul>
<li><a href="http://localhost:7000/oqlhelp/">OQLä½¿ç”¨æ‰‹å†Œ</a></li>
</ul>
</li>
</ul>
<h3 id="oql">OQL</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JavaScript</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">select</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="p">[</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="p">[</span><span class="n">instanceof</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;</span><span class="k">class</span><span class="w"> </span><span class="n">name</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">identifier</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">         </span><span class="p">[</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">&lt;</span><span class="n">JavaScript</span><span class="w"> </span><span class="nb">boolean</span><span class="w"> </span><span class="n">expression</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">filter</span><span class="o">&gt;</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="hprof">HPROF</h3>
<blockquote>
<p><a href="https://docs.oracle.com/javase/8/docs/technotes/samples/hprof.html">HPROF: A Heap/CPU Profiling Tool</a><br>
<a href="https://github.com/bostrt/heapdumpstamp">heapdumpstamp</a><code>è·å–hprofåˆ›å»ºæ—¶é—´æˆ³</code></p>
</blockquote>
<hr>
<h2 id="jstack">jstack</h2>
<blockquote>
<p>jstack [option] pid  ä¸»è¦ç”¨æ¥æŸ¥çœ‹æŸä¸ªJavaè¿›ç¨‹å†…çš„çº¿ç¨‹å †æ ˆä¿¡æ¯</p>
</blockquote>
<ul>
<li>Option:
<ul>
<li>-F: å¼ºåˆ¶äº§ç”Ÿä¸€ä¸ªçº¿ç¨‹dump
<ul>
<li><code>æ³¨æ„</code>æ­¤æ–¹å¼å¾—åˆ°çš„dump<strong>ç¼ºå¤±å¾ˆå¤šä¿¡æ¯</strong>ï¼Œ åªæœ‰çº¿ç¨‹æ ˆå’Œæ“ä½œç³»ç»Ÿçº¿ç¨‹idï¼Œæ²¡æœ‰çº¿ç¨‹åï¼Œçº¿ç¨‹cidï¼Œé”ç­‰ä¿¡æ¯</li>
<li>è€Œä¸”ç›¸å¯¹äºæ²¡æœ‰-Fçš„æ–¹å¼ï¼Œå®ç°åŸç†å®Œå…¨ä¸ä¸€æ ·ï¼Œè§ä¸‹æ–‡é“¾æ¥</li>
</ul>
</li>
<li>-m: æ‰“å°javaå’Œnative frames</li>
<li>-l: æ‰“å°å…³äºé”çš„é™„åŠ ä¿¡æ¯</li>
<li>-J-d64: 64ä½æ¨¡å¼</li>
</ul>
</li>
</ul>
<blockquote>
<p>æ‰¾å‡ºå ç”¨CPUæœ€é«˜çš„çº¿ç¨‹: <a href="https://github.com/Kuangcp/Script/blob/master/shell/assistant/java-tool.sh">å°è£…çš„Shell active_cpu_thread</a></p>
</blockquote>
<ol>
<li><code>jps æˆ–è€… ps aux | grep xxx</code> å¾—åˆ°å¯¹åº”Javaè¿›ç¨‹id</li>
<li><code>top -Hp è¿›ç¨‹id</code> æŸ¥çœ‹ time å ç”¨æœ€é•¿ æˆ–è€… CPUå ç”¨æœ€é«˜ çš„çº¿ç¨‹id</li>
<li><code>printf %x çº¿ç¨‹id</code> å¾—åˆ° 16è¿›åˆ¶çº¿ç¨‹id</li>
<li><code>jstack è¿›ç¨‹id | grep -A 20 16è¿›åˆ¶çº¿ç¨‹id</code> æŸ¥çœ‹è¯¥çº¿ç¨‹çš„æ ˆ,è¿›è€Œåˆ†æåˆ°ä»£ç </li>
</ol>
<blockquote>
<p><a href="https://www.baeldung.com/java-analyze-thread-dumps">How to Analyze Java Thread Dumps</a><code>åˆ†æå·¥å…·å’Œæ€è·¯</code><br>
<a href="https://stackoverflow.com/questions/76476637/openjdk11-jstack-output-explanation">OpenJDK11 jstack output explanation</a><br>
<a href="https://dzone.com/articles/how-analyze-java-thread-dumps">How to Analyze Java Thread Dumps</a></p>
</blockquote>
<p>æ‰©å±•ï¼šé€šè¿‡åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡è·å–stackåˆ†æå‡º æ´»é”ï¼Œæ­»å¾ªç¯ï¼Œæ­»é”ç­‰é—®é¢˜ç‚¹ï¼Œä½†æ˜¯é€šå¸¸è¿™ç±»é—®é¢˜åªèƒ½é€šè¿‡ä¿®å¤ä»£ç å¹¶é‡å¯è§£å†³ï¼Œæ— æ³•çƒ­ä¿®å¤</p>
<p>å¿«é€Ÿåˆ†æ</p>
<blockquote>
<p><a href="https://jstack.review">jstack.review - Java Thread Dump Analyzer</a><code>æ”¯æŒå¤šä»½jstackå¯¹æ¯”</code><br>
<a href="https://github.com/spotify/threaddump-analyzer">threaddump-analyzer</a></p>
</blockquote>
<h3 id="å®ç°åŸç†">å®ç°åŸç†</h3>
<ul>
<li><a href="https://zhuanlan.zhihu.com/p/36224094">Jstack æºç åˆ†æ</a></li>
</ul>
<p>é€šå¸¸æ¥è¯´ jstack pid æŠ¥é”™æ— æ³•attachæ—¶ï¼Œæ„å‘³ç€æ˜¯é«˜è´Ÿè½½æƒ…å†µäº†ï¼Œå¯ä»¥åŠ -Få‚æ•°å°è¯•<br>
<a href="https://stackoverflow.com/questions/26140182/running-jmap-getting-unable-to-open-socket-file">jmap -F and jstack -F</a><code>jmapå’Œjstack é»˜è®¤åŠåŠ -Fé€‰é¡¹èƒŒåå®ç°æœºåˆ¶åŠä¼˜ç¼ºç‚¹</code></p>
<ul>
<li><a href="http://openjdk.java.net/groups/hotspot/docs/Serviceability.html#battach">Dynamic Attach Mechanism</a></li>
<li><a href="http://openjdk.java.net/groups/hotspot/docs/Serviceability.html#bsa">HotSpot Serviceability Agent</a></li>
</ul>
<hr>
<h2 id="jcmd">jcmd</h2>
<blockquote>
<p>jcmd [pid | main-class] command&hellip; | PerfCounter.print | -f filename  <a href="https://docs.oracle.com/en/java/javase/17/docs/specs/man/jcmd.html">Oracle jcmd doc</a></p>
</blockquote>
<ul>
<li>jcmd åˆ—å‡ºæ‰€æœ‰å¯æ“ä½œçš„JVMè¿›ç¨‹</li>
<li>-f filename æ‰§è¡Œæ–‡ä»¶å†…çš„å‘½ä»¤</li>
</ul>
<p><em>command</em></p>
<ul>
<li>
<p>Compiler</p>
<ul>
<li>Compiler.codecache</li>
<li>Compiler.queue</li>
</ul>
</li>
<li>
<p>GC GCä¿¡æ¯ï¼Œè§¦å‘GCï¼Œå †ä¿¡æ¯</p>
<table>
<thead>
<tr>
<th style="text-align:left">å‘½ä»¤</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">GC.run</td>
<td style="text-align:left">è§¦å‘ä¸€æ¬¡Full GC</td>
</tr>
<tr>
<td style="text-align:left">GC.heap_info</td>
<td style="text-align:left">æŸ¥çœ‹å †ä½¿ç”¨ç»Ÿè®¡</td>
</tr>
<tr>
<td style="text-align:left">GC.class_histogram -all</td>
<td style="text-align:left">ç±»å®ä¾‹ç»Ÿè®¡</td>
</tr>
<tr>
<td style="text-align:left">GC.heap_dump -all filename</td>
<td style="text-align:left">åˆ›å»ºæ‰€æœ‰å¯¹è±¡çš„dump</td>
</tr>
<tr>
<td style="text-align:left">GC.finalizer_info</td>
<td style="text-align:left">finalization é˜Ÿåˆ—ä¿¡æ¯</td>
</tr>
</tbody>
</table>
<ul>
<li>å‚æ•° <code>-all</code> å…¨éƒ¨å¯¹è±¡ï¼Œå¦‚æœå»é™¤è¯¥å‚æ•°ï¼Œå°†<strong>è§¦å‘Full GC</strong>æ¥æ‰¾åˆ°æ‰€æœ‰å­˜æ´»å¯¹è±¡</li>
</ul>
</li>
<li>
<p>JFR</p>
<ul>
<li>JFR.start ä¼šè¾“å‡ºæç¤ºä¿¡æ¯</li>
<li>JFR.configure</li>
<li>JFR.stop name=1 filename=now.jfr ï¼ˆ<code>name</code>å‚æ•°ä»startæ‰§è¡Œåçš„æç¤ºä¿¡æ¯ä¸­è·å–ï¼‰</li>
<li>JFR.dump</li>
</ul>
</li>
<li>
<p>JVMTI</p>
</li>
<li>
<p>ManagementAgent</p>
</li>
<li>
<p>System</p>
</li>
<li>
<p>Thread</p>
</li>
<li>
<p>VM</p>
<ul>
<li>VM.command_line</li>
<li>VM.version</li>
<li>VM.uptime [-date]</li>
<li>VM.system_properties</li>
</ul>
</li>
<li>
<p>Memory</p>
<ul>
<li>VM.native_memory</li>
</ul>
</li>
</ul>
<h2 id="jhsdb">jhsdb</h2>
<blockquote>
<p><a href="https://dzone.com/articles/jhsdb-a-new-tool-for-jdk-9">jdk9 jhsdb</a> | <a href="https://docs.oracle.com/javase/9/tools/jhsdb.htm">Oracle jhsdb</a></p>
</blockquote>
<p>JDK9ä¹‹å‰é€šè¿‡æ˜¯Jaræ–¹å¼å¯åŠ¨ HSDB CLHSDBã€‚éƒ¨åˆ†åŠŸèƒ½æœ‰è¢«jmapç­‰å‘½ä»¤å°è£… ä¾‹å¦‚ <code>jmap -heap</code></p>
<ul>
<li><code>java -cp .:sa-jdi.jar sun.jvm.hotspot.CLHSDB</code> HSDBéœ€è¦å’Œç›®æ ‡JVMåŒä¸€ä¸ªç‰ˆæœ¬
<ul>
<li>help æŸ¥çœ‹å¸®åŠ©</li>
<li>jseval æ‰§è¡Œjavascript</li>
<li>attachï¼šè¿æ¥åˆ°ç›®æ ‡è¿›ç¨‹æˆ’core</li>
<li>universeï¼šæŸ¥çœ‹Java heapçš„æƒ…å†µ</li>
<li>inspectï¼šæŸ¥çœ‹æŸä¸ªåœ°å€å¯¹åº”çš„æ•°æ®ç»“æ„çš„å†…å®¹</li>
<li>scanoopsï¼šæ‰«ææŸä¸ªåœ°å€æ®µçš„Javaå¯¹è±¡</li>
</ul>
</li>
</ul>
<p>jstack jmap jinfo jsnap ç­‰å‘½ä»¤åŠŸèƒ½çš„è¿ç§»å’ŒåŠ å¼º</p>
<blockquote>
<p>ä¾‹å¦‚</p>
</blockquote>
<ul>
<li><code>jmap -heap pid</code> =&gt; <code>jhsdb jmap --heap --pid pid</code></li>
</ul>
<hr>
<h1 id="ç»ˆç«¯ç±»å·¥å…·">ç»ˆç«¯ç±»å·¥å…·</h1>
<h2 id="arthas">Arthas</h2>
<blockquote>
<p><a href="https://github.com/alibaba/arthas">Github: Arthas</a><code>é˜¿é‡Œå·´å·´</code></p>
</blockquote>
<blockquote>
<p><a href="https://arthas.aliyun.com/doc/tunnel.html">Arthas Tunnel | arthas</a></p>
</blockquote>
<h2 id="async-profiler">async-profiler</h2>
<blockquote>
<p><a href="https://github.com/jvm-profiling-tools/async-profiler">async-profiler</a><code>CPUå’Œå†…å­˜é‡‡æ · æ¸²æŸ“ç«ç„°å›¾</code></p>
</blockquote>
<h1 id="jvm-sandbox">jvm-sandbox</h1>
<blockquote>
<p><a href="https://github.com/alibaba/jvm-sandbox">jvm-sandbox</a></p>
</blockquote>
<blockquote>
<p><a href="https://www.infoq.cn/article/TSY4lGjvSfwEuXEBW*Gp">JVM SandBox çš„æŠ€æœ¯åŸç†ä¸åº”ç”¨åˆ†æ</a></p>
</blockquote>
<hr>
<blockquote>
<p><a href="https://github.com/vipshop/vjtools">vjtools</a><code>å”¯å“ä¼š</code><br>
<a href="https://github.com/dingjs/javaagent">github.com/dingjs/javaagent</a></p>
</blockquote>
<hr>
<h1 id="å›¾å½¢åŒ–å·¥å…·">å›¾å½¢åŒ–å·¥å…·</h1>
<blockquote>
<p><a href="http://www.fasterj.com/tools/heapdumpanalysers.shtml">Heap Dump Analysers</a><br>
<a href="https://sematext.com/guides/java-monitoring/">Java Monitoring Tools</a><code>Profile APM log ç­‰å¤šä¸ªè§£å†³æ€è·¯</code></p>
</blockquote>
<h2 id="jprofiler">JProfiler</h2>
<blockquote>
<p><a href="https://www.ej-technologies.com/products/jprofiler/overview.html">Official Site</a><code>æ”¶è´¹</code></p>
</blockquote>
<p><a href="https://huminxi.netlify.app/2022/06/24/oom%20%E8%B8%A9%E5%9D%91%E6%97%A5%E8%AE%B0/#more">OOM è¸©å‘æ—¥è®°</a></p>
<h2 id="yourkit">YourKit</h2>
<p><a href="https://www.yourkit.com/java/profiler">YourKit Java Profiler</a><code>æ”¶è´¹</code></p>
<h2 id="visualvm">Visualvm</h2>
<blockquote>
<p><a href="https://github.com/oracle/visualvm">Github:visualvm</a><br>
<a href="https://www.oracle.com/technetwork/java/visualgc-136680.html">visualgc plugin</a></p>
</blockquote>
<blockquote>
<p><a href="https://blog.csdn.net/lc0817/article/details/67014499">å‚è€ƒ: javaå†…å­˜æ³„æ¼çš„å®šä½ä¸åˆ†æ</a>
<a href="https://www.ibm.com/developerworks/cn/java/j-lo-visualvm/index.html">ä½¿ç”¨ VisualVM è¿›è¡Œæ€§èƒ½åˆ†æåŠè°ƒä¼˜</a><br>
<a href="http://www.cnblogs.com/belen/p/5573501.html">å‚è€ƒ: JVisualVMç®€ä»‹ä¸å†…å­˜æ³„æ¼å®æˆ˜åˆ†æ</a></p>
</blockquote>
<ul>
<li><code>Local</code></li>
<li><code>Remote</code>
<ul>
<li>é€šå¸¸ä½¿ç”¨ä¸¤ç§æ–¹å¼è¿æ¥è¿œç¨‹JVM: JMX jstatd</li>
<li><strong><code>jmx</code></strong>
<ul>
<li><a href="/Java/AdvancedLearning/JMX.md">JMX</a></li>
</ul>
</li>
<li><strong><code>jstatd</code></strong>
<ol>
<li>vim jstatd.all.policy
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zed" data-lang="zed"><span class="line"><span class="cl"><span class="w">    </span><span class="n">grant</span><span class="w"> </span><span class="n">codebase</span><span class="w"> </span><span class="err">&#34;</span><span class="n">file</span><span class="o">:</span><span class="err">$</span><span class="p">{</span><span class="n">java</span><span class="p">.</span><span class="n">home</span><span class="p">}</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="nn">lib/</span><span class="n">tools</span><span class="p">.</span><span class="n">jar</span><span class="err">&#34;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">permission</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">security</span><span class="p">.</span><span class="n">AllPermission</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">};</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>jstatd -J-Djava.security.policy=jstatd.all.policy  -p 12028 -J-Djava.rmi.server.logCalls=true</li>
<li>open jvisualvm create a remote with jstatd by above port 12028</li>
</ol>
</li>
</ul>
</li>
</ul>
<blockquote>
<p>æé«˜æ•ˆç‡çš„ä½¿ç”¨åœºæ™¯</p>
</blockquote>
<ol>
<li>å¯ä»¥ä½¿ç”¨ Profiler ä¸‹çš„JDBCï¼Œæ“ä½œä¸šåŠ¡æµç¨‹ï¼Œè·å–æ‰€æœ‰æ‰§è¡Œçš„SQLï¼Œç”¨æ¥åšç´¢å¼•ä¼˜åŒ–ï¼Œæˆ–æ’æŸ¥é—®é¢˜
<ul>
<li><strong>æ³¨æ„å¯èƒ½ä¸å‡†ç¡®</strong>ï¼Œéœ€è¦å¯¹ç›‘æ§åˆ°çš„SQLè¾©è¯å¯¹å¾…
<ul>
<li>çœŸå®æ¡ˆä¾‹ï¼š ç›‘æ§åˆ°å¯¹MySQLæ‰§è¡Œçš„æŸæ¡SQLä¸º <code>xxx in ('NULL', 2, 4)</code>. åº”ç”¨å†™æ³•ä¸è§„èŒƒæœªè¿‡æ»¤é›†åˆä¸­çš„nullå€¼å°±æ‹¼æ¥è¿›äº†æ¡ä»¶</li>
<li>å®é™…ä¸ŠMySQLé©±åŠ¨æ‰§è¡Œçš„SQLæ˜¯ <code>xxx in (NULL, 2, 4)</code> è¿™ä¼šå¯¼è‡´æ­¤å­å¥æ°¸è¿œæ˜¯falseï¼Œè¯¦è§ <a href="/Database/MySQLAdvance.md#%E6%9D%A1%E4%BB%B6%E6%93%8D%E4%BD%9C%E7%AC%A6">MySQL æ¡ä»¶æ“ä½œç¬¦</a></li>
<li>Clone Visualvmçš„ä»£ç å é€šè¿‡GUIæ‰¾åŠŸèƒ½å®ç°ï¼Œå‘ç°å¯ç–‘æ–¹æ³• org.graalvm.visualvm.lib.jfluid.results.jdbc.SQLStatement#getFullSql</li>
<li>é€šè¿‡arthas watchè¯¥æ–¹æ³•çš„è¿”å›åï¼Œç¡®è®¤æ˜¯è¿™ä¸ªæ–¹æ³•çš„é—®é¢˜ï¼Œ</li>
<li>ç»“è®ºä¸ºï¼šåŸºäº PreparedStatement å¾—åˆ°æ‰§è¡ŒSQLçš„å®ç°æ–¹å¼å’ŒMySQLé©±åŠ¨çš„ä¸ä¸€æ ·ã€‚</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<h2 id="mat">MAT</h2>
<blockquote>
<p>Memory Analyzer tool(MAT) | <a href="http://www.eclipse.org/mat/">Official Site</a> | <a href="https://eclipse.dev/mat/downloads.php">download</a></p>
</blockquote>
<blockquote>
<p><a href="http://www.cnblogs.com/lipeineng/p/5824799.html">å‚è€ƒ: JAVA Shallow heap &amp; Retained heap</a><br>
<a href="https://www.cnblogs.com/javaadu/p/11161380.html">å‚è€ƒ:  åˆ©ç”¨MATåˆ†æJVMå†…å­˜é—®é¢˜ï¼Œä»å…¥é—¨åˆ°ç²¾é€š</a><br>
<a href="https://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.mat.ui.help%2Freference%2Foqlsyntax.html"> Official Doc: OQL Syntax</a></p>
</blockquote>
<blockquote>
<p><a href="https://help.eclipse.org/latest/index.jsp?topic=%2Forg.eclipse.mat.ui.help%2Ftasks%2Fanalyzingthreads.html">Analyzing Threads</a></p>
</blockquote>
<p>æ³¨æ„: æœ‰è¿™æ ·çš„ä¸€ç§åœºæ™¯, ä»æ•°æ®åº“è·å–å¤§é‡çš„æ•°æ®åˆ›å»ºä¸ºå¯¹è±¡, å¯¼è‡´ç¬é—´çš„OOM è¿™æ—¶å€™å³ä½¿ä½¿ç”¨ jmap å» dump äº†å¿«ç…§, ä¹Ÿçœ‹ä¸åˆ°å ç”¨å¤§é‡å†…å­˜çš„å¯¹è±¡, å› ä¸ºMATé»˜è®¤å±•ç¤ºçš„æ˜¯GCå¯è¾¾å¯¹è±¡ï¼Œéœ€è¦åœ¨èœå•é€‰æ‹©çœ‹ä¸å¯è¾¾å¯¹è±¡</p>
<p>åˆ†ææ€è·¯ï¼š</p>
<ul>
<li>å¯¹è±¡: histogram, Top ,</li>
<li>çº¿ç¨‹:</li>
<li>ç±»åŠ è½½å™¨ï¼š histogram -&gt; basic -&gt; merge classloader</li>
<li>ä¸å¯è¾¾å¯¹è±¡ï¼š</li>
</ul>
<hr>
<blockquote>
<p><a href="https://baofeidyz.com/feasible-method-for-mat-to-analyze-super-large-heap-snapshots-with-small-memory">matç”¨å°å†…å­˜è§£æè¶…å¤§å †å¿«ç…§çš„å¯è¡Œæ–¹æ³•</a></p>
</blockquote>
<p>åˆ©ç”¨å®‰è£…ç›®å½•ä¸‹çš„ ParseHeapDump.sh å‘½ä»¤è¡Œè§£æ dumpçš„ hprofæ–‡ä»¶
å…¨éƒ¨è§£æï¼š ParseHeapDump.sh ~/Downloads/java_pidxxx.hprof org.eclipse.mat.api:suspects org.eclipse.mat.api:overview org.eclipse.mat.api:top_components</p>
<ul>
<li>ParseHeapDump.sh ~/Downloads/java_pidxxx.hprof org.eclipse.mat.api:suspects</li>
<li>ParseHeapDump.sh ~/Downloads/java_pidxxx.hprof org.eclipse.mat.api:overview</li>
<li>ParseHeapDump.sh ~/Downloads/java_pidxxx.hprof org.eclipse.mat.api:top_components</li>
</ul>
<p>å¹¶ä¸”å¯ä»¥å‘ç°ç»“æœæ–‡ä»¶ä¸ºhtmlï¼Œå¯ä»¥æŒ‚è½½åˆ°nginxç­‰webæœåŠ¡å™¨å…±äº«ç»“æœ</p>
<hr>
<blockquote>
<p>æ¯”è¾ƒå¤šä¸ªdumpæ–‡ä»¶</p>
</blockquote>
<p><a href="https://blog.csdn.net/zhuxingchong/article/details/110449138">MATæ¯”è¾ƒå¤šä¸ªheap dumpæ–‡ä»¶</a></p>
<hr>
<h2 id="jmc">JMC</h2>
<blockquote>
<p><a href="https://docs.oracle.com/en/java/java-components/jdk-mission-control/">Java Mission Control</a></p>
</blockquote>
<ol>
<li>é€šè¿‡JMXè¿æ¥ç›®æ ‡JVM å®æ—¶ç›‘æ§åº”ç”¨æŒ‡æ ‡</li>
<li>é€šè¿‡å¯¹è¿è¡Œä¸­çš„JVMè¿›è¡Œé£è¡Œè®°å½•<code>Flight Recorder</code>, åˆ†ææŒ‡å®šæ—¶é—´å†…ä»£ç çš„å¯ä¼˜åŒ–ç‚¹ï¼ŒæŒ‡æ ‡å€¼å˜åŒ–æƒ…å†µ</li>
</ol>
<p>æŒ‡æ ‡å€¼åŒ…æ‹¬ï¼šJVMçš„ å†…å­˜ï¼ŒCPUï¼ŒGCï¼Œçº¿ç¨‹ï¼Œç±»åŠ è½½ï¼Œç½‘ç»œå’Œæ–‡ä»¶IOï¼› å®¿ä¸»æœºçš„CPUã€å†…å­˜ç­‰æŒ‡æ ‡ï¼Œè”åˆåšå‚è€ƒ</p>
<blockquote>
<p><a href="/Java/AdvancedLearning/JMX.md#JVM%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE">ç›®æ ‡JVMå¼€å¯è¿œç¨‹è®¿é—®JMX</a> <code>æ³¨æ„JDK6åå°±é»˜è®¤å¼€å¯äº†è¿›ç¨‹è®¿é—®JMX</code><br>
<a href="https://www.oracle.com/java/technologies/javase/jmc9-release-notes.html">JMC 9</a><code>è‡ªèº«éœ€è¦JDK17ä»¥ä¸Šè¿è¡Œï¼Œå¯ä»¥ç›‘æ§JDK 7u40åŠå¾€åçš„ç‰ˆæœ¬</code><br>
<a href="https://github.com/thegreystone/jmc-tutorial">thegreystone/jmc-tutorial: A hands-on-lab/tutorial for learning JDK Mission Control 7+.</a></p>
</blockquote>
<h3 id="jfr">JFR</h3>
<blockquote>
<p><a href="https://openjdk.org/jeps/328">JEP 328: Flight Recorder</a><br>
<a href="https://www.baeldung.com/java-flight-recorder-monitoring">Monitoring Java Applications with Flight Recorder | Baeldung</a></p>
</blockquote>
<p>JFR 0.9 ç‰ˆæœ¬å¯¹åº” JDK7 å’Œ JDK8 ï¼ˆå‡ä¸ºå•†ç”¨ç‰ˆæœ¬ï¼‰ï¼Œ JFR 1.0 ç‰ˆæœ¬å¯¹åº” JDK 9 å’Œ JDK 10ï¼Œ JFR 2.0 ç‰ˆæœ¬å¯¹åº” JDK11</p>
<p>å¯¹äºä¸€ä¸ªJVMè¿›ç¨‹å¼€å¯JFRæ—¶ï¼Œå®é™…ä¸Šæ˜¯å¼€å¯äº†ä¸€ä¸ªçº¿ç¨‹æ”¶é›†ä¿¡æ¯ï¼Œå¼€å§‹è¿™ä¸ªçº¿ç¨‹çš„æ—¶å€™é»˜è®¤å†…å­˜ä¸º250Mibï¼Œæ»¡äº†åä¼šå¾ªç¯ä½¿ç”¨ æº¢å‡ºçš„éƒ¨åˆ†ä¸¢å¼ƒæˆ–è€…å†™å…¥é…ç½®çš„æ–‡ä»¶è·¯å¾„ä¸Šã€‚
é»˜è®¤é‡‡é›†å…¨éƒ¨æ”¯æŒçš„äº‹ä»¶ï¼Œå¯ä»¥æŒ‰éœ€è¿‡æ»¤å‡ºå…³å¿ƒçš„äº‹ä»¶ï¼Œé™ä½æ€§èƒ½å½±å“ã€‚<br>
dumpæŒ‡ä»¤æ˜¯å°†å†…å­˜çš„æ•°æ®dumpåˆ°ç£ç›˜ï¼Œçº¿ç¨‹ç»§ç»­åœ¨æ”¶é›† stop åˆ™æ˜¯åœæ­¢è¯¥æ”¶é›†çº¿ç¨‹</p>
<p>å¼€å¯JFRæ–¹å¼</p>
<ul>
<li>JMC: å¯åŠ¨åº”ç”¨ï¼Œå¯åŠ¨JMCï¼ŒJMCè¿æ¥åˆ°ä¸šåŠ¡JVMåï¼Œå¼€å¯ä¸€æ®µæ—¶é—´çš„JFRï¼Œç„¶åç›´æ¥æ“ä½œä¸šåŠ¡é€»è¾‘ï¼ŒJFRç»“æŸåå¯ä»¥ç›´æ¥è¿›è¡Œåˆ†æ</li>
<li>jcmd: ä½¿ç”¨ <a href="#jcmd">jcmd</a> å¯¹å·²ç»è¿è¡Œä¸­çš„åº”ç”¨å¼€å¯ JFR</li>
</ul>
<blockquote>
<p><a href="https://www.cnblogs.com/flydean/p/jvm-diagnostic-memory-leak.html">troubleshootä¹‹:ä½¿ç”¨JFRè§£å†³å†…å­˜æ³„éœ² - flydean - åšå®¢å›­</a><br>
<a href="https://cloud.tencent.com/developer/article/1811738">æ·±åº¦æ¢ç´¢JFR - JFRè¯¦ç»†ä»‹ç»ä¸ç”Ÿäº§é—®é¢˜å®šä½è½åœ° - 1. JFRè¯´æ˜ä¸å¯åŠ¨é…ç½®-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘</a></p>
</blockquote>
<hr>
<h2 id="ibm-heap-analyzer">IBM Heap Analyzer</h2>
<blockquote>
<p><a href="https://www.ibm.com/developerworks/community/alphaworks/tech/heapanalyzer">Official Site</a></p>
</blockquote>
<hr>
<h2 id="intellij-idea">IntelliJ IDEA</h2>
<p><a href="https://www.jetbrains.com/help/idea/read-the-memory-snapshot.html">Analyze the memory snapshot</a></p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Kuangcp</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2018-11-21
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/jvm/">JVM</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/java/test/junit/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Junit</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/java/ecosystem/multiplelanguageinjvm/">
            <span class="next-text nav-default">JVMä¸Šçš„å¤šè¯­è¨€</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="https://github.com/Kuangcp" class="iconfont icon-github" title="github"></a>
  <a href="https://www.kuangcp.top/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" href="https://gitee.com/gin9/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2016 - 
    2025<span class="heart"><i class="iconfont icon-heart"></i></span>
    <span>Kuangcp</span>
    
    <br/><span><a href='http://beian.miit.gov.cn/'; target=_blank>èµ£ICPå¤‡17014189å·</a></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.64437849d125a2d603b3e71d6de5225d641a32d17168a58106e0b61852079683.js"></script>








</body>
</html>
